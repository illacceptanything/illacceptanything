<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ControlFlow</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_webdriver_promise.html">webdriver.promise</a></div><div class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1235">View Source</a></div><h1>class ControlFlow</h1><div class="tags"><span>final</span></div><pre class="inheritance"><a href="class_webdriver_EventEmitter.html">webdriver.EventEmitter</a>
  &#x2514; webdriver.promise.ControlFlow</pre><p>Handles the execution of scheduled tasks, each of which may be an asynchronous operation. The control flow will ensure tasks are executed in the ordered scheduled, starting each task only once those before it have completed.</p><p>Each task scheduled within this flow may return a <a href="class_webdriver_promise_Promise.html"><code>webdriver.promise.Promise</code></a> to indicate it is an asynchronous operation. The ControlFlow will wait for such promises to be resolved before marking the task as completed.</p><p>Tasks and each callback registered on a <a href="class_webdriver_promise_Promise.html"><code>webdriver.promise.Promise</code></a> will be run in their own ControlFlow frame. Any tasks scheduled within a frame will take priority over previously scheduled tasks. Furthermore, if any of the tasks in the frame fail, the remainder of the tasks in that frame will be discarded and the failure will be propagated to the user through the callback/task&#39;s promised result.</p><p>Each time a ControlFlow empties its task queue, it will fire an <a href="enum_webdriver_promise_ControlFlow_EventType.html#IDLE"><code>IDLE</code></a> event. Conversely, whenever the flow terminates due to an unhandled error, it will remove all remaining tasks in its queue and fire an <a href="enum_webdriver_promise_ControlFlow_EventType.html#UNCAUGHT_EXCEPTION"><code>UNCAUGHT_EXCEPTION</code></a> event. If there are no listeners registered with the flow, the error will be rethrown to the global error handler.</p><h2>Instance Methods</h2><div id="annotateError" class="function"><div><h3>annotateError(<wbr>e)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1393">code »</a></span></h3><div class="tags"><span>deprecated</span></div><p>Appends a summary of this instance&#39;s recent task history to the given error&#39;s stack trace. This function will also ensure the error&#39;s stack trace is in canonical form.</p><p><b>Deprecated: </b>Now a no-op; will be removed in 2.46.0.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>e<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></code><dd><p>The error to annotate.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></code><dd><p>The annotated error.</p></dl></div></div></div></div><hr class="fn-sep"><div id="await" class="function"><div><h3>await(<wbr>promise)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1654">code »</a></span></h3><div class="tags"><span>deprecated</span></div><p>Schedules a task that will wait for another promise to resolve. The resolved promise&#39;s value will be returned as the task result.</p><p><b>Deprecated: </b>Use <a href="class_webdriver_promise_ControlFlow.html#wait"><code>wait(promise)</code></a> instead.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>promise<code><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a></code><dd><p>The promise to wait on.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a></code><dd><p>A promise that will resolve when the  task has completed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="clearHistory" class="function"><div><h3>clearHistory()<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1382">code »</a></span></h3><div class="tags"><span>deprecated</span></div><p>Clears this instance&#39;s task history.</p><p><b>Deprecated: </b>Now a no-op; will be removed in 2.46.0.</p></div></div><hr class="fn-sep"><div id="execute" class="function"><div><h3><code>&lt;T&gt;</code> execute(<wbr>fn, opt_description)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1502">code »</a></span></h3><p>Schedules a task for execution. If there is nothing currently in the queue, the task will be executed in the next turn of the event loop. If the task function is a generator, the task will be executed using <a href="namespace_webdriver_promise.html#consume"><code>webdriver.promise.consume</code></a>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>fn<code>function(): (T|<a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a>&lt;T&gt;)</code><dd><p>The function to  call to start the task. If the function returns a  <a href="class_webdriver_promise_Promise.html"><code>webdriver.promise.Promise</code></a>, this instance will wait for it to be  resolved before starting the next task.</p><dt>opt_description<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>A description of the task.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a>&lt;T&gt;</code><dd><p>A promise that will be resolved  with the result of the action.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getHistory" class="function"><div><h3>getHistory()<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1373">code »</a></span></h3><div class="tags"><span>deprecated</span></div><p>Returns a summary of the recent task activity for this instance. This includes the most recently completed task, as well as any parent tasks. In the returned summary, the task at index N is considered a sub-task of the task at index N&#43;1.</p><p><b>Deprecated: </b>Now a no-op; will be removed in 2.46.0.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&gt;</code><dd><p>A summary of this instance&#39;s recent task  activity.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getSchedule" class="function"><div><h3>getSchedule(<wbr>opt_includeStackTraces)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1407">code »</a></span></h3><p>Generates an annotated string describing the internal state of this control flow, including the currently executing as well as pending tasks. If <code>opt_includeStackTraces &#61;&#61;&#61; true</code>, the string will include the stack trace from when each task was scheduled.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_includeStackTraces<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>Whether to include the stack traces  from when each task was scheduled. Defaults to false.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>String representation of this flow&#39;s internal state.</p></dl></div></div></div></div><hr class="fn-sep"><div id="reset" class="function"><div><h3>reset()<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1354">code »</a></span></h3><p>Resets this instance, clearing its queue and removing all event listeners.</p></div></div><hr class="fn-sep"><div id="timeout" class="function"><div><h3>timeout(<wbr>ms, opt_description)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1533">code »</a></span></h3><p>Inserts a <code>setTimeout</code> into the command queue. This is equivalent to a thread sleep in a synchronous programming language.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>ms<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The timeout delay, in milliseconds.</p><dt>opt_description<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>A description to accompany the timeout.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a></code><dd><p>A promise that will be resolved with  the result of the action.</p></dl></div></div></div></div><hr class="fn-sep"><div id="toString" class="function"><div><h3>toString()<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1346">code »</a></span></h3><p>Returns a string representation of this control flow, which is its current <a href="class_webdriver_promise_ControlFlow.html#getSchedule"><code>schedule</code></a>, sans task stack traces.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The string representation of this contorl flow.</p></dl></div></div></div></div><hr class="fn-sep"><div id="wait" class="function"><div><h3><code>&lt;T&gt;</code> wait(<wbr>condition, opt_timeout, opt_message)<span class="codelink"><a href="source/lib/webdriver/promise.js.src.html#l1573">code »</a></span></h3><p>Schedules a task that shall wait for a condition to hold. Each condition function may return any value, but it will always be evaluated as a boolean.</p><p>Condition functions may schedule sub-tasks with this instance, however, their execution time will be factored into whether a wait has timed out.</p><p>In the event a condition returns a Promise, the polling loop will wait for it to be resolved before evaluating whether the condition has been satisfied. The resolution time for a promise is factored into whether a wait has timed out.</p><p>If the condition function throws, or returns a rejected promise, the wait task will fail.</p><p>If the condition is defined as a promise, the flow will block on that promise&#39;s resolution, up to <code>timeout</code> milliseconds. If <code>timeout &#61;&#61;&#61; 0</code>, the flow will block indefinitely on the promise&#39;s resolution.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>condition<code>(<a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a>&lt;T&gt;|function(): ?)</code><dd><p>The condition to poll,  or a promise to wait on.</p><dt>opt_timeout<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>How long to wait, in milliseconds, for the  condition to hold before timing out; defaults to 0.</p><dt>opt_message<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>An optional error message to include if the  wait times out; defaults to the empty string.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a>&lt;T&gt;</code><dd><p>A promise that will be fulfilled  when the condition has been satisified. The promise shall be rejected if  the wait times out waiting for the condition.</p></dl></div><div class="fn-details"><div><b>Throws</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError">TypeError</a></code><dd><p>If condition is not a function or promise or if timeout  is not a number &gt;&#61; 0.</p></dl></div></div></div></div><h2>Types</h2><dl><dt><a href="enum_webdriver_promise_ControlFlow_EventType.html">ControlFlow.EventType</a><dd><p>Events that may be emitted by an <a href="class_webdriver_promise_ControlFlow.html"><code>webdriver.promise.ControlFlow</code></a>.</p></dl></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-modules" checked/><label for="nav-modules"><h3>Modules</h3></label><div><ul><li><a href="module_selenium-webdriver.html">selenium-webdriver</a><li><a href="module_selenium-webdriver__base.html">selenium-webdriver/_base</a><li><a href="module_selenium-webdriver_builder.html">selenium-webdriver/builder</a><li><a href="module_selenium-webdriver_chrome.html">selenium-webdriver/chrome</a><li><a href="module_selenium-webdriver_error.html">selenium-webdriver/error</a><li><a href="module_selenium-webdriver_executors.html">selenium-webdriver/executors</a><li><a href="module_selenium-webdriver_firefox.html">selenium-webdriver/firefox</a><li><a href="module_selenium-webdriver_firefox_binary.html">selenium-webdriver/firefox/binary</a><li><a href="module_selenium-webdriver_firefox_extension.html">selenium-webdriver/firefox/extension</a><li><a href="module_selenium-webdriver_firefox_profile.html">selenium-webdriver/firefox/profile</a><li><a href="module_selenium-webdriver_http.html">selenium-webdriver/http</a><li><a href="module_selenium-webdriver_http_util.html">selenium-webdriver/http/util</a><li><a href="module_selenium-webdriver_ie.html">selenium-webdriver/ie</a><li><a href="module_selenium-webdriver_io.html">selenium-webdriver/io</a><li><a href="module_selenium-webdriver_io_exec.html">selenium-webdriver/io/exec</a><li><a href="module_selenium-webdriver_net.html">selenium-webdriver/net</a><li><a href="module_selenium-webdriver_net_portprober.html">selenium-webdriver/net/portprober</a><li><a href="module_selenium-webdriver_opera.html">selenium-webdriver/opera</a><li><a href="module_selenium-webdriver_phantomjs.html">selenium-webdriver/phantomjs</a><li><a href="module_selenium-webdriver_proxy.html">selenium-webdriver/proxy</a><li><a href="module_selenium-webdriver_remote.html">selenium-webdriver/remote</a><li><a href="module_selenium-webdriver_safari.html">selenium-webdriver/safari</a><li><a href="module_selenium-webdriver_testing.html">selenium-webdriver/testing</a><li><a href="module_selenium-webdriver_testing_assert.html">selenium-webdriver/testing/assert</a></ul></div></div><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3>Types</h3></label><div><ul><li><a href="namespace_bot.html">bot</a><li><a href="class_bot_Error.html">bot.Error</a><li><a href="enum_bot_Error_State.html">bot.Error.State</a><li><a href="enum_bot_ErrorCode.html">bot.ErrorCode</a><li><a href="namespace_bot_json.html">bot.json</a><li><a href="namespace_bot_response.html">bot.response</a><li><a href="namespace_bot_userAgent.html">bot.userAgent</a><li><a href="namespace_webdriver.html">webdriver</a><li><a href="class_webdriver_ActionSequence.html">webdriver.ActionSequence</a><li><a href="class_webdriver_Alert.html">webdriver.Alert</a><li><a href="class_webdriver_AlertPromise.html">webdriver.AlertPromise</a><li><a href="enum_webdriver_Browser.html">webdriver.Browser</a><li><a href="enum_webdriver_Button.html">webdriver.Button</a><li><a href="namespace_webdriver_By.html">webdriver.By</a><li><a href="class_webdriver_Capabilities.html">webdriver.Capabilities</a><li><a href="enum_webdriver_Capability.html">webdriver.Capability</a><li><a href="class_webdriver_Command.html">webdriver.Command</a><li><a href="interface_webdriver_CommandExecutor.html">webdriver.CommandExecutor</a><li><a href="enum_webdriver_CommandName.html">webdriver.CommandName</a><li><a href="class_webdriver_EventEmitter.html">webdriver.EventEmitter</a><li><a href="class_webdriver_FileDetector.html">webdriver.FileDetector</a><li><a href="enum_webdriver_Key.html">webdriver.Key</a><li><a href="class_webdriver_Locator.html">webdriver.Locator</a><li><a href="class_webdriver_Serializable.html">webdriver.Serializable</a><li><a href="class_webdriver_Session.html">webdriver.Session</a><li><a href="class_webdriver_TouchSequence.html">webdriver.TouchSequence</a><li><a href="class_webdriver_UnhandledAlertError.html">webdriver.UnhandledAlertError</a><li><a href="class_webdriver_WebDriver.html">webdriver.WebDriver</a><li><a href="class_webdriver_WebDriver_Logs.html">webdriver.WebDriver.Logs</a><li><a href="class_webdriver_WebDriver_Navigation.html">webdriver.WebDriver.Navigation</a><li><a href="class_webdriver_WebDriver_Options.html">webdriver.WebDriver.Options</a><li><a href="class_webdriver_WebDriver_TargetLocator.html">webdriver.WebDriver.TargetLocator</a><li><a href="class_webdriver_WebDriver_Timeouts.html">webdriver.WebDriver.Timeouts</a><li><a href="class_webdriver_WebDriver_Window.html">webdriver.WebDriver.Window</a><li><a href="class_webdriver_WebElement.html">webdriver.WebElement</a><li><a href="class_webdriver_WebElementPromise.html">webdriver.WebElementPromise</a><li><a href="namespace_webdriver_http.html">webdriver.http</a><li><a href="interface_webdriver_http_Client.html">webdriver.http.Client</a><li><a href="class_webdriver_http_Executor.html">webdriver.http.Executor</a><li><a href="class_webdriver_http_Request.html">webdriver.http.Request</a><li><a href="class_webdriver_http_Response.html">webdriver.http.Response</a><li><a href="namespace_webdriver_logging.html">webdriver.logging</a><li><a href="class_webdriver_logging_Entry.html">webdriver.logging.Entry</a><li><a href="enum_webdriver_logging_Level.html">webdriver.logging.Level</a><li><a href="class_webdriver_logging_Preferences.html">webdriver.logging.Preferences</a><li><a href="enum_webdriver_logging_Type.html">webdriver.logging.Type</a><li><a href="namespace_webdriver_promise.html">webdriver.promise</a><li><a href="class_webdriver_promise_Callback_.html">webdriver.promise.Callback_</a><li><a href="class_webdriver_promise_CancellationError.html">webdriver.promise.CancellationError</a><li><a href="class_webdriver_promise_ControlFlow.html">webdriver.promise.ControlFlow</a><li><a href="enum_webdriver_promise_ControlFlow_EventType.html">webdriver.promise.ControlFlow.EventType</a><li><a href="class_webdriver_promise_Deferred.html">webdriver.promise.Deferred</a><li><a href="class_webdriver_promise_Frame_.html">webdriver.promise.Frame_</a><li><a href="class_webdriver_promise_MicroTask_.html">webdriver.promise.MicroTask_</a><li><a href="class_webdriver_promise_Promise.html">webdriver.promise.Promise</a><li><a href="enum_webdriver_promise_Promise_State_.html">webdriver.promise.Promise.State_</a><li><a href="class_webdriver_promise_Task_.html">webdriver.promise.Task_</a><li><a href="interface_webdriver_promise_Thenable.html">webdriver.promise.Thenable</a><li><a href="namespace_webdriver_stacktrace.html">webdriver.stacktrace</a><li><a href="class_webdriver_stacktrace_Frame.html">webdriver.stacktrace.Frame</a><li><a href="class_webdriver_stacktrace_Snapshot.html">webdriver.stacktrace.Snapshot</a><li><a href="namespace_webdriver_testing.html">webdriver.testing</a><li><a href="class_webdriver_testing_Assertion.html">webdriver.testing.Assertion</a><li><a href="class_webdriver_testing_Assertion_DelegatingMatcher_.html">webdriver.testing.Assertion.DelegatingMatcher_</a><li><a href="class_webdriver_testing_ContainsMatcher.html">webdriver.testing.ContainsMatcher</a><li><a href="class_webdriver_testing_NegatedAssertion.html">webdriver.testing.NegatedAssertion</a><li><a href="namespace_webdriver_testing_assert.html">webdriver.testing.assert</a><li><a href="namespace_webdriver_testing_asserts.html">webdriver.testing.asserts</a><li><a href="namespace_webdriver_until.html">webdriver.until</a><li><a href="class_webdriver_until_Condition.html">webdriver.until.Condition</a></ul></div></div><h3><a href="Changes.html">Changes</a></h3></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>