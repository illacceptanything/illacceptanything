# Server-side
<reply>
<data1>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:00 GMT
Server: test-server/fake
Content-Type: text/html
Set-Cookie: test1=one; domain=foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test2=two; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test3=three; domain=foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Content-Length: 29

run 1: set cookie 1, 2 and 3
</data1>
<data2>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:01 GMT
Server: test-server/fake
Content-Type: text/html
Set-Cookie: test4=four; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Set-Cookie: test5=five; domain=host.foo.com; expires=Tue Feb 1 11:56:27 MET 2007
Content-Length: 26

run 2: set cookie 4 and 5
</data2>
<data3>
HTTP/1.1 200 OK
Date: Thu, 09 Nov 2010 14:49:02 GMT
Server: test-server/fake
Content-Type: text/html
Funny-head: yesyes
Set-Cookie: test4=overwritten4; domain=host.foo.com; expires=Thu Dec 31 23:59:59 MET 2009
Set-Cookie: test1=overwritten1; domain=foo.com; expires=Tue Feb 2 11:56:27 MET 2007
Content-Type: text/html
Content-Length: 32

run 3: overwrite cookie 1 and 4
</data5>
</reply>

# Client-side
<client>
<server>
http
</server>
<name>
HTTP with shared cookie list (and dns cache)
</name>
<tool>
lib506
</tool>
<command>
http://%HOSTIP:%HOSTPORT/506
</command>
</client>

# Verify data after the test has been "shot"
<verify>
<stdout>
GLOBAL_INIT
SHARE_INIT
CURL_LOCK_DATA_COOKIE
CURL_LOCK_DATA_DNS
*** run 1
CURLOPT_SHARE
lock:   share  <Pigs in space>: 0
unlock: share  <Pigs in space>: 1
PERFORM
lock:   dns    <Pigs in space>: 2
unlock: dns    <Pigs in space>: 3
lock:   dns    <Pigs in space>: 4
unlock: dns    <Pigs in space>: 5
lock:   cookie <Pigs in space>: 6
unlock: cookie <Pigs in space>: 7
lock:   cookie <Pigs in space>: 8
unlock: cookie <Pigs in space>: 9
lock:   cookie <Pigs in space>: 10
unlock: cookie <Pigs in space>: 11
lock:   cookie <Pigs in space>: 12
unlock: cookie <Pigs in space>: 13
run 1: set cookie 1, 2 and 3
lock:   dns    <Pigs in space>: 14
unlock: dns    <Pigs in space>: 15
lock:   dns    <Pigs in space>: 16
unlock: dns    <Pigs in space>: 17
CLEANUP
lock:   cookie <Pigs in space>: 18
unlock: cookie <Pigs in space>: 19
*** run 2
CURLOPT_SHARE
lock:   share  <Pigs in space>: 20
unlock: share  <Pigs in space>: 21
PERFORM
lock:   dns    <Pigs in space>: 22
unlock: dns    <Pigs in space>: 23
lock:   cookie <Pigs in space>: 24
unlock: cookie <Pigs in space>: 25
lock:   cookie <Pigs in space>: 26
unlock: cookie <Pigs in space>: 27
lock:   cookie <Pigs in space>: 28
unlock: cookie <Pigs in space>: 29
run 2: set cookie 4 and 5
lock:   dns    <Pigs in space>: 30
unlock: dns    <Pigs in space>: 31
lock:   dns    <Pigs in space>: 32
unlock: dns    <Pigs in space>: 33
CLEANUP
lock:   cookie <Pigs in space>: 34
unlock: cookie <Pigs in space>: 35
*** run 3
CURLOPT_SHARE
lock:   share  <Pigs in space>: 36
unlock: share  <Pigs in space>: 37
CURLOPT_COOKIEJAR
PERFORM
lock:   dns    <Pigs in space>: 38
unlock: dns    <Pigs in space>: 39
lock:   cookie <Pigs in space>: 40
unlock: cookie <Pigs in space>: 41
lock:   cookie <Pigs in space>: 42
unlock: cookie <Pigs in space>: 43
lock:   cookie <Pigs in space>: 44
unlock: cookie <Pigs in space>: 45
run 3: overwrite cookie 1 and 4
lock:   dns    <Pigs in space>: 46
unlock: dns    <Pigs in space>: 47
lock:   dns    <Pigs in space>: 48
unlock: dns    <Pigs in space>: 49
try SHARE_CLEANUP...
lock:   share  <Pigs in space>: 50
unlock: share  <Pigs in space>: 51
SHARE_CLEANUP failed, correct
CLEANUP
lock:   cookie <Pigs in space>: 52
unlock: cookie <Pigs in space>: 53
SHARE_CLEANUP
lock:   share  <Pigs in space>: 54
unlock: share  <Pigs in space>: 55
GLOBAL_CLEANUP
</stdout>
<stderr>
http://%HOSTIP:%HOSTPORT/506 
</stderr>
<file name="log/jar506">
# Netscape HTTP Cookie File
# http://www.netscape.com/newsref/std/cookie_spec.html
# This file was generated by libcurl! Edit at your own risk.

.foo.com	TRUE	/	FALSE	1170413787	test1	overwritten1
.host.foo.com	TRUE	/	FALSE	1170327387	test2	two
.foo.com	TRUE	/	FALSE	1170327387	test3	three
.host.foo.com	TRUE	/	FALSE	1262300399	test4	overwritten4
.host.foo.com	TRUE	/	FALSE	1170327387	test5	five
</file>
</verify>
