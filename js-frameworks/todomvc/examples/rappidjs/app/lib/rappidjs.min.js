/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/*!
 * flow.js JavaScript Library v0.2.2
 * https://github.com/it-ony/flow.js
 *
 * Copyright 2012, Tony Findeisen
 * Licensed under the MIT license.
 * https://raw.github.com/it-ony/flow.js/master/LICENSE
 *
 * Date: Mon Mar 12 2012 12:36:34 GMT+0100 (CET)
 */
var requirejs,require,define;(function(global){function isFunction(a){return ostring.call(a)==="[object Function]"}function isArray(a){return ostring.call(a)==="[object Array]"}function each(a,b){if(a){var c;for(c=0;c<a.length;c+=1)if(b(a[c],c,a))break}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1;c-=1)if(b(a[c],c,a))break}}function hasProp(a,b){return a.hasOwnProperty(b)}function eachProp(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&b(a[c],c))break}function mixin(a,b,c){b&&eachProp(b,function(b,d){if(c||!hasProp(a,d))a[d]=b})}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeContextModuleFunc(a,b,c){return function(){var d=aps.call(arguments,0),e;return c&&isFunction(e=d[d.length-1])&&(e.__requireJsBuild=!0),d.push(b),a.apply(null,d)}}function addRequireMethods(a,b,c){each([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(d){a[d[0]]=makeContextModuleFunc(b[d[1]||d[0]],c)})}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function q(a){var b,c;for(b=0;a[b];b+=1){c=a[b];if(c===".")a.splice(b,1),b-=1;else if(c===".."){if(b===1&&(a[2]===".."||a[0]===".."))break;b>0&&(a.splice(b-1,2),b-=2)}}}function r(a,c,d){var e=c&&c.split("/"),f=b.map,g=f&&f["*"],h,i,j,k,l,m,n,o;a&&a.charAt(0)==="."&&(c?(b.pkgs[c]?e=[c]:e=e.slice(0,e.length-1),a=e.concat(a.split("/")),q(a),i=b.pkgs[h=a[0]],a=a.join("/"),i&&a===h+"/"+i.main&&(a=h)):a.indexOf("./")===0&&(a=a.substring(2)));if(d&&(e||g)&&f){k=a.split("/");for(l=k.length;l>0;l-=1){n=k.slice(0,l).join("/");if(e)for(m=e.length;m>0;m-=1){j=f[e.slice(0,m).join("/")];if(j){j=j[n];if(j){o=j;break}}}!o&&g&&g[n]&&(o=g[n]);if(o){k.splice(0,l,o),a=k.join("/");break}}}return a}function s(a){isBrowser&&each(scripts(),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===n.contextName)return b.parentNode.removeChild(b),!0})}function t(a){var c=b.paths[a];if(c&&isArray(c)&&c.length>1)return s(a),c.shift(),n.undef(a),n.require([a]),!0}function u(a,b,c,d){var e=a?a.indexOf("!"):-1,h=null,k=b?b.name:null,l=a,m=!0,o,p,q,s;return a||(m=!1,a="_@r"+(i+=1)),e!==-1&&(h=a.substring(0,e),a=a.substring(e+1,a.length)),h&&(h=r(h,k,d)),a&&(h?(q=f[h],q&&q.normalize?o=q.normalize(a,function(a){return r(a,k,d)}):o=r(a,k,d)):(o=r(a,k,d),p=g[o],p||(p=n.nameToUrl(a,null,b),g[o]=p))),s=h&&!q&&!c?"_unnormalized"+(j+=1):"",{prefix:h,name:o,parentMap:b,unnormalized:!!s,url:p,originalName:l,isDefine:m,id:(h?h+"!"+(o||""):o)+s}}function v(a){var b=a.id,d=c[b];return d||(d=c[b]=new n.Module(a)),d}function w(a,b,d){var e=a.id,g=c[e];hasProp(f,e)&&(!g||g.defineEmitComplete)?b==="defined"&&d(f[e]):v(a).on(b,d)}function x(a,b){var d=a.requireModules,e=!1;b?b(a):(each(d,function(b){var d=c[b];d&&(d.error=a,d.events.error&&(e=!0,d.emit("error",a)))}),e||req.onError(a))}function y(){globalDefQueue.length&&(apsp.apply(e,[e.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function z(a,b,c){var d=a&&a.map,e=makeContextModuleFunc(c||n.require,d,b);return addRequireMethods(e,n,d),e}function A(a){delete c[a],each(k,function(b,c){if(b.map.id===a)return k.splice(c,1),b.defined||(n.waitCount-=1),!0})}function B(a,b){var d=a.map.id,e=a.depMaps,f;if(!a.inited)return;return b[d]?a:(b[d]=!0,each(e,function(a){var e=a.id,g=c[e];if(!g)return;return!g.inited||!g.enabled?(f=null,delete b[d],!0):f=B(g,b)}),f)}function C(a,b,d){var e=a.map.id,g=a.depMaps;if(!a.inited||!a.map.isDefine)return;return b[e]?f[e]:(b[e]=a,each(g,function(f){var g=f.id,h=c[g],i;if(o[g])return;if(h){if(!h.inited||!h.enabled){d[e]=!0;return}i=C(h,b,d),d[g]||a.defineDepById(g,i)}}),a.check(!0),f[e])}function D(a){a.check()}function E(){var a=b.waitSeconds*1e3,d=a&&n.startTime+a<(new Date).getTime(),e=[],f=!1,g=!0,h,i,j,m;if(l)return;l=!0,eachProp(c,function(a){h=a.map,i=h.id;if(!a.enabled)return;if(!a.error)if(!a.inited&&d)t(i)?(m=!0,f=!0):(e.push(i),s(i));else if(!a.inited&&a.fetched&&h.isDefine){f=!0;if(!h.prefix)return g=!1}});if(d&&e.length)return j=makeError("timeout","Load timeout for modules: "+e,null,e),j.contextName=n.contextName,x(j);g&&(each(k,function(a){if(a.defined)return;var b=B(a,{}),c={};b&&(C(b,c,{}),eachProp(c,D))}),eachProp(c,D)),(!d||m)&&f&&(isBrowser||isWebWorker)&&!p&&(p=setTimeout(function(){p=0,E()},50)),l=!1}function F(a){v(u(a[0],null,!0)).init(a[1],a[2])}function G(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function H(a){var b=a.currentTarget||a.srcElement;return G(b,n.onScriptLoad,"load","onreadystatechange"),G(b,n.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}var b={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},c={},d={},e=[],f={},g={},h={},i=1,j=1,k=[],l,m,n,o,p;return o={require:function(a){return z(a)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports=f[a.map.id]={}},module:function(a){return a.module={id:a.map.id,uri:a.map.url,config:function(){return b.config&&b.config[a.map.id]||{}},exports:f[a.map.id]}}},m=function(a){this.events=d[a.id]||{},this.map=a,this.shim=b.shim[a.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},m.prototype={init:function(a,b,c,d){d=d||{};if(this.inited)return;this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),each(a,bind(this,function(a,b){typeof a=="string"&&(a=u(a,this.map.isDefine?this.map:this.map.parentMap,!1,!0),this.depMaps.push(a));var d=o[a.id];if(d){this.depExports[b]=d(this);return}this.depCount+=1,w(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),c&&w(a,"error",c)})),this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check()},defineDepById:function(a,b){var c;return each(this.depMaps,function(b,d){if(b.id===a)return c=d,!0}),this.defineDep(c,b)},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(this.fetched)return;this.fetched=!0,n.startTime=(new Date).getTime();var a=this.map;a.prefix?this.callPlugin():this.shim?z(this,!0)(this.shim.deps||[],bind(this,function(){this.load()})):this.load()},load:function(){var a=this.map.url;h[a]||(h[a]=!0,n.load(this.map.id,a))},check:function(a){if(!this.enabled)return;var b=this.map.id,d=this.depExports,e=this.exports,g=this.factory,h,i;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(g)){if(this.events.error)try{e=n.execCb(b,g,d,e)}catch(j){h=j}else e=n.execCb(b,g,d,e);this.map.isDefine&&(i=this.module,i&&i.exports!==undefined&&i.exports!==this.exports?e=i.exports:e===undefined&&this.usingExports&&(e=this.exports));if(h)return h.requireMap=this.map,h.requireModules=[this.map.id],h.requireType="define",x(this.error=h)}else e=g;this.exports=e,this.map.isDefine&&!this.ignore&&(f[b]=e,req.onResourceLoad&&req.onResourceLoad(n,this.map,this.depMaps)),delete c[b],this.defined=!0,n.waitCount-=1,n.waitCount===0&&(k=[])}this.defining=!1,a||this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var a=this.map,d=a.id,e=u(a.prefix,null,!1,!0);w(e,"defined",bind(this,function(e){var f=this.map.name,g=this.map.parentMap?this.map.parentMap.name:null,h,i,j;if(this.map.unnormalized){e.normalize&&(f=e.normalize(f,function(a){return r(a,g,!0)})),i=u(a.prefix+"!"+f),w(i,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),j=c[i.id],j&&(this.events.error&&j.on("error",bind(this,function(a){this.emit("error",a)})),j.enable());return}h=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),h.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[d],eachProp(c,function(a){a.map.id.indexOf(d+"_unnormalized")===0&&A(a.map.id)}),x(a)}),h.fromText=function(a,b){var c=useInteractive;c&&(useInteractive=!1),req.exec(b),c&&(useInteractive=!0),n.completeLoad(a)},e.load(a.name,z(a.parentMap,!0,function(a,b){return n.require(a,b)}),h,b)})),n.enable(e,this),this.pluginMaps[e.id]=e},enable:function(){this.enabled=!0,this.waitPushed||(k.push(this),n.waitCount+=1,this.waitPushed=!0),each(this.depMaps,bind(this,function(a){var b=a.id,d=c[b];!o[b]&&d&&!d.enabled&&n.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=c[a.id];b&&!b.enabled&&n.enable(a,this)})),this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),a==="error"&&delete this.events[a]}},n={config:b,contextName:a,registry:c,defined:f,urlMap:g,urlFetched:h,waitCount:0,defQueue:e,Module:m,makeModuleMap:u,configure:function(a){a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/");var c=b.paths,d=b.pkgs,e=b.shim,f=b.map||{};mixin(b,a,!0),mixin(c,a.paths,!0),b.paths=c,a.map&&(mixin(f,a.map,!0),b.map=f),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),a.exports&&!a.exports.__buildReady&&(a.exports=n.makeShimExports(a.exports)),e[b]=a}),b.shim=e),a.packages&&(each(a.packages,function(a){var b;a=typeof a=="string"?{name:a}:a,b=a.location,d[a.name]={name:a.name,location:b||a.name,main:(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),b.pkgs=d),(a.deps||a.callback)&&n.require(a.deps||[],a.callback)},makeShimExports:function(a){var b;return typeof a=="string"?(b=function(){return getGlobal(a)},b.exports=a,b):function(){return a.apply(global,arguments)}},requireDefined:function(a,b){return hasProp(f,u(a,b,!1,!0).id)},requireSpecified:function(a,b){return a=u(a,b,!1,!0).id,hasProp(f,a)||hasProp(c,a)},require:function(b,c,d,g){var h,i,j,k,l;if(typeof b=="string")return isFunction(c)?x(makeError("requireargs","Invalid require call"),d):req.get?req.get(n,b,c):(h=b,g=c,j=u(h,g,!1,!0),i=j.id,hasProp(f,i)?f[i]:x(makeError("notloaded",'Module name "'+i+'" has not been loaded yet for context: '+a)));d&&!isFunction(d)&&(g=d,d=undefined),c&&!isFunction(c)&&(g=c,c=undefined),y();while(e.length){l=e.shift();if(l[0]===null)return x(makeError("mismatch","Mismatched anonymous define() module: "+l[l.length-1]));F(l)}return k=v(u(null,g)),k.init(b,c,d,{enabled:!0}),E(),n.require},undef:function(a){var b=u(a,null,!0),e=c[a];delete f[a],delete g[a],delete h[b.url],delete d[a],e&&(e.events.defined&&(d[a]=e.events),A(a))},enable:function(a,b){var d=c[a.id];d&&v(a).enable()},completeLoad:function(a){var d=b.shim[a]||{},g=d.exports&&d.exports.exports,h,i,j;y();while(e.length){i=e.shift();if(i[0]===null){i[0]=a;if(h)break;h=!0}else i[0]===a&&(h=!0);F(i)}j=c[a];if(!h&&!f[a]&&j&&!j.inited){if(b.enforceDefine&&(!g||!getGlobal(g))){if(t(a))return;return x(makeError("nodefine","No define call for "+a,null,[a]))}F([a,d.deps||[],d.exports])}E()},toUrl:function(a,b){var c=a.lastIndexOf("."),d=null;return c!==-1&&(d=a.substring(c,a.length),a=a.substring(0,c)),n.nameToUrl(a,d,b)},nameToUrl:function(a,c,d){var e,f,g,h,i,j,k,l,m;a=r(a,d&&d.id,!0);if(req.jsExtRegExp.test(a))l=a+(c||"");else{e=b.paths,f=b.pkgs,i=a.split("/");for(j=i.length;j>0;j-=1){k=i.slice(0,j).join("/"),g=f[k],m=e[k];if(m){isArray(m)&&(m=m[0]),i.splice(0,j,m);break}if(g){a===g.name?h=g.location+"/"+g.main:h=g.location,i.splice(0,j,h);break}}l=i.join("/")+(c||".js"),l=(l.charAt(0)==="/"||l.match(/^[\w\+\.\-]+:/)?"":b.baseUrl)+l}return b.urlArgs?l+((l.indexOf("?")===-1?"?":"&")+b.urlArgs):l},load:function(a,b){req.load(n,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if(a.type==="load"||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=H(a);n.completeLoad(b.id)}},onScriptError:function(a){var b=H(a);if(!t(b.id))return x(makeError("scripterror","Script error",a,[b.id]))}}}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(a){if(a.readyState==="interactive")return interactiveScript=a}),interactiveScript)}var version="2.0.0",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,ostring=Object.prototype.toString,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1,req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(a,b,c,d){var e=defContextName,f,g;return!isArray(a)&&typeof a!="string"&&(g=a,isArray(b)?(a=b,b=c,c=d):a=[]),g&&g.context&&(e=g.context),f=contexts[e],f||(f=contexts[e]=req.s.newContext(e)),g&&f.configure(g),f.require(a,b,c)},req.config=function(a){return req(a)},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),addRequireMethods(req,contexts[defContextName]),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(a){throw a},req.load=function(a,b,c){var d=a&&a.config||{},e;if(isBrowser)return e=d.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),e.type=d.scriptType||"text/javascript",e.charset="utf-8",e.setAttribute("data-requirecontext",a.contextName),e.setAttribute("data-requiremodule",b),e.attachEvent&&!(e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,e.attachEvent("onreadystatechange",a.onScriptLoad)):(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)),e.src=c,currentlyAddingScript=e,baseElement?head.insertBefore(e,baseElement):head.appendChild(e),currentlyAddingScript=null,e;isWebWorker&&(importScripts(c),a.completeLoad(b))},isBrowser&&eachReverse(scripts(),function(a){head||(head=a.parentNode),dataMain=a.getAttribute("data-main");if(dataMain)return cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript.replace(jsSuffixRegExp,"")),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0}),define=function(a,b,c){var d,e;typeof a!="string"&&(c=b,b=a,a=null),isArray(b)||(c=b,b=[]),!b.length&&isFunction(c)&&c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(c.length===1?["require"]:["require","exports","module"]).concat(b)),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),define("js/lib/require.js",function(){});var exports=typeof exports=="undefined"?this:exports;exports.parser=function(){var a={parse:function(a,b){function i(a,b,c){var d=a,e=c-a.length;for(var f=0;f<e;f++)d=b+d;return d}function j(a){var b=a.charCodeAt(0);if(b<=255)var c="x",d=2;else var c="u",d=4;return"\\"+c+i(b.toString(16).toUpperCase(),"0",d)}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,j)+'"'}function l(a){if(d<f)return;d>f&&(f=d,g=[]),g.push(a)}function m(){var b="varName@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d).match(/^[a-zA-Z$_]/)!==null){var i=a.charAt(d);d++}else{var i=null;e&&l("[a-zA-Z$_]")}if(i!==null){var j=[];if(a.substr(d).match(/^[a-zA-Z0-9$_\- ]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[a-zA-Z0-9$_\\- ]")}while(k!==null){j.push(k);if(a.substr(d).match(/^[a-zA-Z0-9$_\- ]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[a-zA-Z0-9$_\\- ]")}}if(j!==null)var m=[i,j];else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a,b){return a?a+b.join(""):!1}(m[0],m[1]):null;if(n!==null)var o=n;else{var o=null;d=f}if(o!==null)var p=o;else{var q=d,r=[];if(r!==null)var p=r;else var p=null}return h[b]={nextPos:d,result:p},p}function n(){var b="string@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="'"){var i="'";d+=1}else{var i=null;e&&l('"\'"')}if(i!==null){var j=[],k=d;if(a.length>d){var m=a.charAt(d);d++}else{var m=null;e&&l("any character")}var n=m!==null?function(a){return a==="'"?null:a}(m):null;if(n!==null)var o=n;else{var o=null;d=k}while(o!==null){j.push(o);var k=d;if(a.length>d){var m=a.charAt(d);d++}else{var m=null;e&&l("any character")}var n=m!==null?function(a){return a==="'"?null:a}(m):null;if(n!==null)var o=n;else{var o=null;d=k}}if(j!==null){if(a.substr(d,1)==="'"){var p="'";d+=1}else{var p=null;e&&l('"\'"')}if(p!==null)var q=[i,j,p];else{var q=null;d=g}}else{var q=null;d=g}}else{var q=null;d=g}var r=q!==null?function(a){return a.join("")}(q[1]):null;if(r!==null)var s=r;else{var s=null;d=f}return h[b]={nextPos:d,result:s},s}function o(){var b="number@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="-"){var i="-";d+=1}else{var i=null;e&&l('"-"')}var j=i!==null?i:"";if(j!==null){if(a.substr(d).match(/^[0-9]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[0-9]")}if(k!==null){var m=[];while(k!==null){m.push(k);if(a.substr(d).match(/^[0-9]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[0-9]")}}}else var m=null;if(m!==null)var n=[j,m];else{var n=null;d=g}}else{var n=null;d=g}var o=n!==null?function(a,b){return parseInt(b.join(""),10)*(a?-1:1)}(n[0],n[1]):null;if(o!==null)var p=o;else{var p=null;d=f}return h[b]={nextPos:d,result:p},p}function p(){var b="float@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=o();if(i!==null){if(a.substr(d,1)==="."){var j=".";d+=1}else{var j=null;e&&l('"."')}if(j!==null){if(a.substr(d).match(/^[0-9]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[0-9]")}if(k!==null){var m=[];while(k!==null){m.push(k);if(a.substr(d).match(/^[0-9]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[0-9]")}}}else var m=null;if(m!==null)var n=[i,j,m];else{var n=null;d=g}}else{var n=null;d=g}}else{var n=null;d=g}var p=n!==null?function(a,b){return parseFloat(a+"."+b.join(""),10)}(n[0],n[2]):null;if(p!==null)var q=p;else{var q=null;d=f}return h[b]={nextPos:d,result:q},q}function q(){var b="boolean@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d;if(a.substr(d,4)==="true"){var g="true";d+=4}else{var g=null;e&&l('"true"')}var i=g!==null?function(){return!0}():null;if(i!==null)var j=i;else{var j=null;d=f}if(j!==null)var k=j;else{var m=d;if(a.substr(d,5)==="false"){var n="false";d+=5}else{var n=null;e&&l('"false"')}var o=n!==null?function(){return!1}():null;if(o!==null)var p=o;else{var p=null;d=m}if(p!==null)var k=p;else var k=null}return h[b]={nextPos:d,result:k},k}function r(){var b="index@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="["){var i="[";d+=1}else{var i=null;e&&l('"["')}if(i!==null){var j=o();if(j!==null){if(a.substr(d,1)==="]"){var k="]";d+=1}else{var k=null;e&&l('"]"')}if(k!==null)var m=[i,j,k];else{var m=null;d=g}}else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a){return a}(m[1]):null;if(n!==null)var p=n;else{var p=null;d=f}return h[b]={nextPos:d,result:p},p}function s(){var a="parameter@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=n();if(c!==null)var e=c;else{var f=q();if(f!==null)var e=f;else{var g=p();if(g!==null)var e=g;else{var i=o();if(i!==null)var e=i;else{var j=A();if(j!==null)var e=j;else{var k=y();if(k!==null)var e=k;else var e=null}}}}}return h[a]={nextPos:d,result:e},e}function t(){var b="parameterArray@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=s(),j=i!==null?i:"";if(j!==null){var k=[],m=d,n=d;if(a.substr(d,1)===","){var o=",";d+=1}else{var o=null;e&&l('","')}if(o!==null){var p=s();if(p!==null)var q=[o,p];else{var q=null;d=n}}else{var q=null;d=n}var r=q!==null?function(a){return a}(q[1]):null;if(r!==null)var t=r;else{var t=null;d=m}while(t!==null){k.push(t);var m=d,n=d;if(a.substr(d,1)===","){var o=",";d+=1}else{var o=null;e&&l('","')}if(o!==null){var p=s();if(p!==null)var q=[o,p];else{var q=null;d=n}}else{var q=null;d=n}var r=q!==null?function(a){return a}(q[1]):null;if(r!==null)var t=r;else{var t=null;d=m}}if(k!==null)var u=[j,k];else{var u=null;d=g}}else{var u=null;d=g}var v=u!==null?function(a,b){return a?[a].concat(b):[]}(u[0],u[1]):null;if(v!==null)var w=v;else{var w=null;d=f}return h[b]={nextPos:d,result:w},w}function u(){var a="var@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=d,e=d,f=m();if(f!==null){var g=r(),i=g!==null?g:"";if(i!==null)var j=[f,i];else{var j=null;d=e}}else{var j=null;d=e}var k=j!==null?function(a,b){return{name:a,type:"var",index:b}}(j[0],j[1]):null;if(k!==null)var l=k;else{var l=null;d=c}return h[a]={nextPos:d,result:l},l}function v(){var b="fnc@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=m();if(i!==null){if(a.substr(d,1)==="("){var j="(";d+=1}else{var j=null;e&&l('"("')}if(j!==null){var k=t(),n=k!==null?k:"";if(n!==null){if(a.substr(d,1)===")"){var o=")";d+=1}else{var o=null;e&&l('")"')}if(o!==null){var p=r(),q=p!==null?p:"";if(q!==null)var s=[i,j,n,o,q];else{var s=null;d=g}}else{var s=null;d=g}}else{var s=null;d=g}}else{var s=null;d=g}}else{var s=null;d=g}var u=s!==null?function(a,b,c){return{name:a,type:"fnc",parameter:b,index:c}}(s[0],s[2],s[4]):null;if(u!==null)var v=u;else{var v=null;d=f}return h[b]={nextPos:d,result:v},v}function w(){var a="pathElement@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=d,e=r(),f=e!==null?function(a){return{type:"index",index:a}}(e):null;if(f!==null)var g=f;else{var g=null;d=c}if(g!==null)var i=g;else{var j=v();if(j!==null)var i=j;else{var k=u();if(k!==null)var i=k;else var i=null}}return h[a]={nextPos:d,result:i},i}function x(){var b="path@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=w();if(i!==null){var j=[],k=d,m=d;if(a.substr(d,1)==="."){var n=".";d+=1}else{var n=null;e&&l('"."')}if(n!==null){var o=w();if(o!==null)var p=[n,o];else{var p=null;d=m}}else{var p=null;d=m}var q=p!==null?function(a){return a}(p[1]):null;if(q!==null)var r=q;else{var r=null;d=k}while(r!==null){j.push(r);var k=d,m=d;if(a.substr(d,1)==="."){var n=".";d+=1}else{var n=null;e&&l('"."')}if(n!==null){var o=w();if(o!==null)var p=[n,o];else{var p=null;d=m}}else{var p=null;d=m}var q=p!==null?function(a){return a}(p[1]):null;if(q!==null)var r=q;else{var r=null;d=k}}if(j!==null)var s=[i,j];else{var s=null;d=g}}else{var s=null;d=g}var t=s!==null?function(a,b){return[a].concat(b)}(s[0],s[1]):null;if(t!==null)var u=t;else{var u=null;d=f}return h[b]={nextPos:d,result:u},u}function y(){var b="binding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="{"){var i="{";d+=1}else{var i=null;e&&l('"{"')}if(i!==null){var j=x();if(j!==null){if(a.substr(d,1)==="}"){var k="}";d+=1}else{var k=null;e&&l('"}"')}if(k!==null)var m=[i,j,k];else{var m=null;d=g}}else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a){return a?{path:a,type:"normal"}:!1}(m[1]):null;if(n!==null)var o=n;else{var o=null;d=f}return h[b]={nextPos:d,result:o},o}function z(){var b="twoWayBinding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,2)==="{{"){var i="{{";d+=2}else{var i=null;e&&l('"{{"')}if(i!==null){var j=x();if(j!==null){var k=d,m=d;if(a.substr(d,1)==="|"){var n="|";d+=1}else{var n=null;e&&l('"|"')}if(n!==null){var o=x();if(o!==null)var p=[n,o];else{var p=null;d=m}}else{var p=null;d=m}var q=p!==null?function(a){return a}(p[1]):null;if(q!==null)var r=q;else{var r=null;d=k}var s=r!==null?r:"";if(s!==null){var t=d,u=d;if(a.substr(d,1)==="|"){var v="|";d+=1}else{var v=null;e&&l('"|"')}if(v!==null){var w=x();if(w!==null)var y=[v,w];else{var y=null;d=u}}else{var y=null;d=u}var z=y!==null?function(a){return a}(y[1]):null;if(z!==null)var A=z;else{var A=null;d=t}var B=A!==null?A:"";if(B!==null){if(a.substr(d,2)==="}}"){var C="}}";d+=2}else{var C=null;e&&l('"}}"')}if(C!==null)var D=[i,j,s,B,C];else{var D=null;d=g}}else{var D=null;d=g}}else{var D=null;d=g}}else{var D=null;d=g}}else{var D=null;d=g}var E=D!==null?function(a,b,c){return a?{path:a,type:"twoWay",transformBack:b||!1,transform:c||!1}:!1}(D[1],D[2],D[3]):null;if(E!==null)var F=E;else{var F=null;d=f}return h[b]={nextPos:d,result:F},F}function A(){var b="staticBinding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="$"){var i="$";d+=1}else{var i=null;e&&l('"$"')}if(i!==null){var j=y();if(j!==null)var k=[i,j];else{var k=null;d=g}}else{var k=null;d=g}var m=k!==null?function(a){return a.type="static",a}(k[1]):null;if(m!==null)var n=m;else{var n=null;d=f}return h[b]={nextPos:d,result:n},n}function B(){var b="text@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=z(),i=g!==null?function(a){return[a]}(g):null;if(i!==null)var j=i;else{var j=null;d=f}if(j!==null)var k=j;else{var m=[],n=A();if(n!==null)var o=n;else{var p=y();if(p!==null)var o=p;else{if(a.length>d){var q=a.charAt(d);d++}else{var q=null;e&&l("any character")}if(q!==null)var o=q;else var o=null}}while(o!==null){m.push(o);var n=A();if(n!==null)var o=n;else{var p=y();if(p!==null)var o=p;else{if(a.length>d){var q=a.charAt(d);d++}else{var q=null;e&&l("any character")}if(q!==null)var o=q;else var o=null}}}if(m!==null)var k=m;else var k=null}return h[b]={nextPos:d,result:k},k}function C(){function b(a){a.sort();var b=null,c=[];for(var d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(g),e=Math.max(d,f),h=e<a.length?k(a.charAt(e)):"end of input";return"Expected "+c+" but "+h+" found."}function D(){var b=1,c=1,d=!1;for(var e=0;e<f;e++){var g=a.charAt(e);g==="\n"?(d||b++,c=1,d=!1):g==="\r"|g==="\u2028"||g==="\u2029"?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}var c={binding:y,"boolean":q,"float":p,fnc:v,index:r,number:o,parameter:s,parameterArray:t,path:x,pathElement:w,staticBinding:A,string:n,text:B,twoWayBinding:z,"var":u,varName:m};if(b!==undefined){if(c[b]===undefined)throw new Error("Invalid rule name: "+k(b)+".")}else b="text";var d=0,e=!0,f=0,g=[],h={},E=c[b]();if(E===null||d!==a.length){var F=D();throw new this.SyntaxError(C(),F.line,F.column)}return E},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}(),define("js/lib/parser",function(){return exports.parser}),define("js/lib/parser",function(){});var inherit;(function(a,b){inherit=function(a,b,c,d){var e=Array.prototype.slice.call(arguments);e[0]instanceof Object&&e.unshift(null),e[2]instanceof Function&&e.splice(2,0,null),a=e[0],b=e[1]||{},c=e[2]||{},d=e[3]||Object;var f=function(){if(this.ctor)return this.ctor.apply(this,arguments)};if(d.constructor instanceof Function){function g(){}g.prototype=d.prototype,f.prototype=new g,f.prototype.constructor=b,b&&a&&(f.prototype.constructor.name=a),f.prototype.base=d.prototype}else f.prototype=d,f.prototype.constructor=b,f.prototype.base=d;for(var h in b)if(b.hasOwnProperty(h)){var i=f.prototype[h];f.prototype[h]=b[h],i instanceof Function&&(f.prototype[h].baseImplementation=i)}for(var j in c)c.hasOwnProperty(j)&&(f[j]=c[j]);return f.prototype.callBase=inherit.callBase,f},inherit.callBase=function(){var a=Array.prototype.slice.call(arguments);return a.length==0&&(a=Array.prototype.slice.call(arguments.callee.caller.arguments)),arguments.callee.caller.baseImplementation.apply(this,a)},Function.prototype.inherit=function(a,b,c){var d=Array.prototype.slice.call(arguments);return d[0]instanceof Object&&d.unshift(null),inherit(d[0],d[1],d[2],this)},Function.prototype.callBase=function(){var a=Array.prototype.slice.call(arguments),b=a.shift();if(b&&b.base){var c=arguments.callee.caller;return this==c?this.baseImplementation.apply(b,a):this.apply(b,a)}throw"base not definied"},Function.prototype.classof=function(a){if(!a)return!1;if(a instanceof Function)return a===this||this.prototype instanceof a;throw new Error("factory must be a function")},inherit.Base=inherit({ctor:function(){}}),b.inherit=inherit})(this,typeof exports=="undefined"?this:exports),define("inherit",function(){return inherit}),define("inherit",function(){}),define("js/core/Base",["inherit"],function(a){var b=a.Base.inherit("js.core.Base",{ctor:function(){},runsInBrowser:function(){return typeof window!="undefined"},log:function(a,c){c=c||b.LOGLEVEL.INFO,a instanceof Error&&(a=a.toString());if(b.logger.length)for(var d=0;d<b.logger.length;d++)b.logger[d].log(a,c);else typeof console!="undefined"&&(console[c]||console.log).call(console,a)}});return b.logger=[],b.LOGLEVEL={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},b}),define("js/core/EventDispatcher",["js/core/Base"],function(a){Function.prototype.on=function(){var a=Array.prototype.slice.call(arguments,0);this._events=this._events||[];for(var b=0;b<a.length;b++){var c=a[b];this._events.push(c)}return this},Function.prototype.onChange=function(){var a=Array.prototype.slice.call(arguments,0);this._events=this._events||[],this._attributes=this._attributes||[];for(var b=0;b<a.length;b++){var c=a[b];this._attributes.push(c),c="change:"+c,this._events.push(c)}return this};var b,c=a.inherit("js.core.EventDispatcher",{ctor:function(){this.callBase(),this._eventHandlers={}},bind:function(a,b,d){if(b){d=d||this;var e=this._eventHandlers[a]||(this._eventHandlers[a]=[]),f=new c.EventHandler(b,d);return e.push(f),f}return console.warn('no eventHandler for "'+a+'"'),null},trigger:function(a,d,e){if(this._eventHandlers[a]){d instanceof c.Event||(d=new c.Event(d)),e||(e=arguments.callee.caller),d.target=e,d.type=a;var f=this._eventHandlers[a];for(var g=0;g<f.length;g++)if(f[g]){var h=f[g].trigger(d,e);h!==b&&(ret=h,h===!1&&(d.preventDefault(),d.stopPropagation()));if(d.isImmediatePropagationStopped)break}}return d},unbind:function(a,b,c){if(!a)this._eventHandlers={};else if(!b)this._eventHandlers[a]=[];else if(this._eventHandlers[a]){var d=this._eventHandlers[a];for(var e=d.length-1;e>=0;e--)d[e].$callback==b&&(!c||c===d[e].scope)&&d.splice(e,1)}},destroy:function(){this._eventHandlers={}}});return c.Event=a.inherit({ctor:function(a,b){this.$=a,this.target=b,this.isDefaultPrevented=!1,this.isPropagationStopped=!1,this.isImmediatePropagationStopped=!1},preventDefault:function(){this.isDefaultPrevented=!0;var a=this.$.orginalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=!0,this.stopPropagation()}}),c.EventHandler=a.inherit({ctor:function(a,b){this.scope=b,this.$callback=a},trigger:function(a,b){return this.$callback.call(this.scope,a,b),!a.isPropagationStopped}}),c}),function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new I(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.3";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),!!e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a}),b},w.sortBy=function(a,b,c){var d=w.isFunction(b)?b:function(a){return a[b]};return w.pluck(w.map(a,function(a,b,e){return{value:a,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c===void 0?1:d===void 0?-1:c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):a.toArray&&w.isFunction(a.toArray)?a.toArray():w.values(a):[]},w.size=function(a){return w.isArray(a)?a.length:w.keys(a).length},w.first=w.head=w.take=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return a.length<3&&(b=!0),w.reduce(d,function(c,d,f){if(b?w.last(c)!==d||!c.length:!w.include(c,d))c.push(d),e.push(a[f]);return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1),!0);return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h,i=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var j=function(){e=null,g&&a.apply(c,d),i()};return e||(e=setTimeout(j,b)),f?g=!0:h=a.apply(c,d),i(),f=!0,h}},w.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.pick=function(a){var b={};return x(w.flatten(g.call(arguments,1)),function(c){c in a&&(b[c]=a[c])}),b},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(a==null)return!0;if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isFinite=function(a){return w.isNumber(a)&&isFinite(a)},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(a,b){if(a==null)return null;var c=a[b];return w.isFunction(c)?c.call(a):c},w.mixin=function(a){x(w.functions(a),function(b){K(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var E in D)D[D[E]]=E;var F=/\\|'|\r|\n|\t|\u2028|\u2029/g,G=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(G,function(a,b){return D[b]})};w.template=function(a,b,c){c=w.defaults(c||{},w.templateSettings);var d="__p+='"+a.replace(F,function(a){return"\\"+D[a]}).replace(c.escape||C,function(a,b){return"'+\n_.escape("+H(b)+")+\n'"}).replace(c.interpolate||C,function(a,b){return"'+\n("+H(b)+")+\n'"}).replace(c.evaluate||C,function(a,b){return"';\n"+H(b)+"\n;__p+='"})+"';\n";c.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+d+"return __p;\n";var e=new Function(c.variable||"obj","_",d);if(b)return e(b,w);var f=function(a){return e.call(this,a,w)};return f.source="function("+(c.variable||"obj")+"){\n"+d+"}",f},w.chain=function(a){return w(a).chain()};var I=function(a){this._wrapped=a};w.prototype=I.prototype;var J=function(a,b){return b?w(a).chain():a},K=function(a,b){I.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),J(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];I.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],J(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];I.prototype[a]=function(){return J(b.apply(this._wrapped,arguments),this._chain)}}),I.prototype.chain=function(){return this._chain=!0,this},I.prototype.value=function(){return this._wrapped}}.call(this),define("underscore",function(){return _}),define("underscore",function(){}),define("js/core/Binding",["js/core/EventDispatcher","js/lib/parser","underscore"],function(a,b,c){var d=function(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];if(d.type!=h)return!1;b.push(d.name)}return b.join(".")},e,f=a.inherit("js.core.Binding",{defaults:{event:"change",path:null,twoWay:!1},ctor:function(a){if(!e)try{e=requirejs("js/core/Bindable")}catch(b){e=null}this.callBase(),this.$=a,c.defaults(this.$,this.defaults),this.initialize()},transform:function(a){return a},transformBack:function(a){return a},initialize:function(){this._checkAttributes(),this.$parameters=[],this.$events=[],this.$subBinding=null,this.$.rootScope||(this.$.rootScope=this);var a=this.$.scope;c.isString(this.$.path)&&(this.$.path=b.parse(this.$.path,"path")),this.$.key=this.$.path[0];var d=this;if(this.$.key.type==g){var e=this.$.key.name;this.$parameters=this.$.key.parameter;if(c.isFunction(a[e])){var f=a[e],h=[];if(f._attributes&&f._attributes.length>0)this.$.scope.bind("change",this._changeCallback,this),this.$events.push({eventType:"change",callback:this._changeCallback});else{f._events?h=f._events:h=[];var i,j;for(var k=0;k<h.length;k++)i=h[k],a.bind(i,this._callback,this),this.$events.push({eventType:i,callback:this._callback})}var l=function(){d.trigger()},m;for(var n=0;n<this.$parameters.length;n++)m=this.$parameters[n],c.isObject(m)&&(this.$parameters[n]=this.$.bindingCreator.create(m,this.$.target,l));this.$.fnc=f,this.$.fnc.trigger=function(){d.trigger()}}}else this.$.event="change:"+this.$.key.name,this.$events.push({eventType:this.$.event,callback:this._callback}),a.bind(this.$.event,this._callback,this);this.$.twoWay===!0&&this.$.path.length===1&&(this.$.targetEvent="change:"+this.$.targetKey,this.$.target.bind(this.$.targetEvent,this._revCallback,this)),this._createSubBinding(),a.bind("destroy",function(){d.destroy()}),this.$.path.length===1&&this.trigger()},_checkAttributes:function(){if(!this.$.path)throw"No path defined!";if(!this.$.scope)throw"No scope defined!";if(this.$.twoWay){if(!this.$.target)throw"TwoWay binding, but no target defined!";if(!this.$.target instanceof e)throw"Target is not a Bindable!";if(!this.$.targetKey)throw"TwoWay binding, but no target key defined!"}this.$.bindingCreator||(this.$.bindingCreator=this),this.$.transform&&(this.transform=this.$.transform),this.$.transformBack&&(this.transformBack=this.$.transformBack)},_createSubBinding:function(){if(this.$.path.length>1){var a;this.$.fnc?a=this.getValue():a=this.$.scope.$[this.$.key.name],a&&a instanceof e&&(this.$subBinding=new f({scope:a,path:this.$.path.slice(1),target:this.$.target,targetKey:this.$.targetKey,rootScope:this.$.rootScope,callback:this.$.callback,context:this.$.context,twoWay:this.$.twoWay,transform:this.$.transform,transformBack:this.$.transformBack,bindingCreator:this.$.bindingCreator}))}},_revCallback:function(a){if(this.$.fnc){var b=this._getFncParameters();b.unshift(a.$),this.$.fnc.apply(this.$.scope,b)}else this.$.scope.set(d(this.$.path),this.transformBack(a.$))},_changeCallback:function(a){for(var b=0;b<this.$.fnc._attributes.length;b++)if(!c.isUndefined(a.$[this.$.fnc._attributes[b]])){this.trigger();return}},_callback:function(){this.$subBinding&&(this.$subBinding.destroy(),this.$subBinding=null),this._createSubBinding(),this.trigger()},destroy:function(){var a;for(var b=0;b<this.$events.length;b++)a=this.$events[b],this.$.scope.unbind(a.eventType,a.callback);this.$.twoWay===!0&&this.$.target.unbind(this.$.targetEvent,this._revCallback),this.$subBinding&&(this.$subBinding.destroy(),delete this.$subBinding);for(var c=0;c<this.$parameters.length;c++){var d=this.$parameters[c];d instanceof f&&d.destroy()}},_getFncParameters:function(){var a=[];for(var b=0;b<this.$parameters.length;b++){var c=this.$parameters[b];c instanceof f&&(c=c.getValue()),a.push(c)}return a},getValue:function(){return this.$subBinding?this.$subBinding.getValue():this.$.fnc?this.$.fnc.apply(this.$.scope,this._getFncParameters()):this.$.path.length==1?this.$.scope.get(this.$.key.name):null},getContextValue:function(){return this.$.context&&this.$.context.length>1?f.contextToString(this.$.context):this.getValue()},trigger:function(){var a=this.getContextValue();this.$.targetKey?this.$.target.set(this.$.targetKey,this.transform(a)):this.$.callback&&this.$.callback.call(this.$.target,this.transform(a))},toString:function(){return this.getValue()},create:function(a,b,c){var d={scope:this.$.scope,target:b,callback:c,path:a.path,twoWay:a.type===j,bindingCreator:this.$.bindingCreator},e,g;return a.transform&&(e=a.transform.pop(),g=this.get(a.transform),g&&(d.transform=g[e.name])),a.transformBack&&(e=a.transformBack.pop(),g=this.get(a.transform),g&&(d.transformBack=g[e.name])),new f(d)}}),g=f.TYPE_FNC="fnc",h=f.TYPE_VAR="var",i=f.TYPE_STATIC="static",j=f.TYPE_TWOWAY="twoWay";return f.contextToString=function(a){var b="",c;for(var d=0;d<a.length;d++)c=a[d],c instanceof f&&(c=c.getValue()),c!==null&&typeof c!="undefined"&&(b+=c);return b},f}),define("js/core/BindingCreator",["js/core/EventDispatcher","js/lib/parser","js/core/Binding","underscore"],function(a,b,c,d){function e(a,b){var d=a[0];d.type==c.TYPE_FNC?b=b.getScopeForFncName(d.name):b=b.getScopeForKey(d.name);var e=b;while(e&&a.length>0){d=a.shift();if(d.type==c.TYPE_FNC)return e[d.name];d.type==c.TYPE_VAR&&(e=e.get(d.name))}return!1}return a.inherit("js.core.BindingCreator",{create:function(a,b,f,g){var h=a.path,i=h[0],j,k=b;i.type!=c.TYPE_FNC&&f==i.name&&(k=k.$parentScope),i.type==c.TYPE_FNC?j=k.getScopeForFncName(i.name):j=k.getScopeForKey(i.name);if(j){if(a.type!=="static"){var l;d.isFunction(f)&&(l=f);var m=a.type==c.TYPE_TWOWAY,n={scope:j,path:h,target:b,twoWay:m,context:g,bindingCreator:this};if(m){if(a.transform){var o=e(a.transform,k);o&&(n.transform=o)}if(a.transformBack){var p=e(a.transformBack,k);p&&(n.transformBack=p)}}return l?n.callback=l:n.targetKey=f,new c(n)}return j.get(a.path)}throw"Couldn't find scope for "+i.name},evaluate:function(a,e,f){if(!d.isString(a))return a;var g=b.parse(a,"text"),h,i=[];for(var j=0;j<g.length;j++){var k=g[j];k.length?g[j]=k:(h=this.create(k,e,f,g),h instanceof c&&i.push(h),g[j]=h)}return i.length>0?i[0].getContextValue():g.length>0?g.length===1?g[0]:c.contextToString(g):a}})}),define("js/core/Bindable",["js/core/EventDispatcher","js/lib/parser","js/core/Binding","underscore"],function(a,b,c,d){var e=/^(.*)\[(\d+)\]$/,f,g,h=a.inherit("js.core.Bindable",{ctor:function(a){this.$eventBindables=[],this.callBase(null),this.$={},d.extend(this._eventAttributes,this.base._eventAttributes||{}),a=a||{};var b=this._defaultAttributes();for(var c in b)b.hasOwnProperty(c)&&(a.hasOwnProperty(c)||(d.isFunction(b[c])?a[c]=new b[c]:a[c]=d.clone(b[c])));this.$=a,this.$previousAttributes=d.clone(a)},defaults:{},_defaultAttributes:function(){return this._generateDefaultsChain("defaults")},_generateDefaultsChain:function(a){var b=this[a],c=this.base;while(c)d.defaults(b,c[a]),c=c.base;return b},set:function(a,b,c){var e={};if(d.isString(a)){var f=a.split(".");if(f.length>1){var g=this.get(f.shift());if(g&&g.set)return g.set(f.join("."),b,c),this}e[a]=b}else c=b,e=a;c=c||{silent:!1,unset:!1};if(c.unset)for(a in e)e.hasOwnProperty(a)&&(e[a]=void 0);var h={},i=this.$,j,k;for(a in e)e.hasOwnProperty(a)&&(j=e[a],c.unset===!0?delete i[a]:d.isEqual(i[a],e[a])||(k=i[a],this.$previousAttributes[a]=k,i[a]=e[a],h[a]=i[a]));this._commitChangedAttributes(h);if(c.silent===!1&&d.size(h)>0){for(a in h)h.hasOwnProperty(a)&&this.trigger("change:"+a,h[a],this);this.trigger("change",h,this)}return this},get:function(a,c){c||(c=a,a=this);if(!c)return null;var e;d.isArray(c)?e=c:d.isObject(c)?e=[c]:e=b.parse(c,"path");var f;while(a&&e.length>0){f=e.shift();if(f.type=="fnc"){var g=a[f.name],i=f.parameter;for(var j=0;j<i.length;j++){var k=i[j];d.isObject(k)&&(k.type="static",i[j]=this.get(k.path))}a=g.apply(a,i)}else f.type=="var"&&(a instanceof h?e.length===0?a=a.$[f.name]:a=a.get(f.name):a=a[f.name]);a&&f.index!==""&&(d.isArray(a)?a=a[f.index]:a.at&&(a=a.at(f.index)))}return a},has:function(a){return!d.isUndefined(this.get(a))},_commitChangedAttributes:function(a){},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(){return this.set(this.$,{unset:!0})},bind:function(a,b,e,f){if(b instanceof Function&&d.isString(a))return this.callBase(a,b,e);d.isArray(a)&&a.length>0&&(f=e,e=b,b=a[1],a=a[2]);var g=new i({path:a,event:b,scope:f,callback:e,value:null});g.set("binding",new c({path:a,scope:this,target:g,targetKey:"value"})),this.$eventBindables.push(g)},unbind:function(a,b,c,d){if(b instanceof Function)this.callBase(a,b,c);else{var e;for(var f=this.$eventBindables.length-1;f>=0;f--)e=this.$eventBindables[f],e.$.scope===d&&e.$.path===a&&e.$.event===b&&e.$.callback===c&&(e.destroy(),this.$eventBindables.slice(f,1))}},destroy:function(){this.callBase();for(var a=0;a<this.$eventBindables.length;a++)this.$eventBindables[a].destroy();return this.trigger("destroy",this),this}}),i=h.inherit({_commitChangedAttributes:function(a){this.callBase(),this._unbindEvent(this.$previousAttributes.value),d.isUndefined(a.value)||this._bindEvent(a.value)},_unbindEvent:function(b){b&&b instanceof a&&b.unbind(this.$.event,this.$.callback,this.$.scope)},_bindEvent:function(b){b&&b instanceof a&&b.bind(this.$.event,this.$.callback,this.$.scope)},destroy:function(){this._unbindEvent(this.$.value),this.$.binding.destroy(),this.callBase()}});return h}),define("js/core/Element",["js/core/Bindable","underscore","js/core/BindingCreator"],function(a,b,c){function f(a){if(b.isString(a)){var c=Number(a);if(!isNaN(c))return c;if(a==="true")return!0;if(a==="false")return!1}return a}var d,e=new c,g=a.inherit("js.core.Element",{ctor:function(a,b,c,f,g){a=a||{},b||g||(g=this),this.$descriptor=b,this.$systemManager=c,this.$parentScope=f||null,this.$rootScope=g||null,this.$attributesNamespace=this.$attributesNamespace||{},this.$bindingCreator=e,this.callBase(a),this._initializeAttributes(this.$),(b===d||b===null)&&this._initialize(this.$creationPolicy)},_getAttributesFromDescriptor:function(a){this.$attributesNamespace=this.$attributesNamespace||{};var b={};if(a&&a.attributes){var c,d;for(var e=0;e<a.attributes.length;e++)c=a.attributes[e],c.nodeName.indexOf("xmlns")!==0&&(d=this._getLocalNameFromNode(c),b[d]=f(c.value),c.namespaceURI&&(this.$attributesNamespace[d]=c.namespaceURI))}return b},_getLocalNameFromNode:function(a){return a.localName?a.localName:a.name.split(":").pop()},defaults:{creationPolicy:"auto"},_initializeAttributes:function(a){},_initializeDescriptors:function(){},_initialize:function(a,b){if(this.$initialized)return;this._preinitialize(),this.initialize(),this._initializeDescriptors(),(this==this.$rootScope||b)&&this._initializeBindings()},_initializeBindings:function(){this._initializationComplete()},initialize:function(){},find:function(a){var b=this.getScopeForKey(a);return this===b?this.get(a):b!=null?b.get(a):null},getScopeForKey:function(a){var c=this.$[a];return b.isUndefined(c)?this.$parentScope?this.$parentScope.getScopeForKey(a):null:this},getScopeForFncName:function(a){var c=this[a];return!b.isUndefined(c)&&b.isFunction(c)?this:this.$parentScope?this.$parentScope.getScopeForFncName(a):null},_preinitialize:function(){},_initializationComplete:function(){this._commitChangedAttributes(this.$),this.$initialized=!0},_getTextContentFromDescriptor:function(a){var b=a.textContent||a.text||a.data;if(!b){b="";for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType==1||d.nodeType==4)b+=this._getTextContentFromDescriptor(d)}}return b}});return g.xmlStringToDom=function(a){if(window&&window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml").documentElement;if(typeof ActiveXObject!="undefined"){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async=!1,b.loadXML(a),b.documentElement}throw"Couldn't parse xml string"},g}),define("js/core/TextElement",["js/core/Element","underscore"],function(a,b){return a.inherit("js.core.TextElement",{_initializeBindings:function(){this.$.textContent=this.$bindingCreator.evaluate(this.$.textContent||"",this,"textContent"),this.callBase()},_initializeDescriptors:function(){this.$descriptor&&(this.$.textContent=this._getTextContentFromDescriptor(this.$descriptor))},render:function(){return this.$initialized||this._initialize(this.$creationPolicy),this.$el=this.$systemManager.$document.createTextNode(""),this._renderTextContent(this.$.textContent),this.$el},_renderTextContent:function(a){if(b.isUndefined(this.$.textContent)||a===null)a="";this.$el.nodeValue=a},_commitChangedAttributes:function(a){this.$el&&(b.isUndefined(a.textContent)||this._renderTextContent(a.textContent))}})}),define("js/core/Component",["require","js/core/Element","js/core/TextElement","js/core/Bindable","js/core/EventDispatcher","underscore"],function(a,b,c,d,e,f){var g,h,i=b.inherit("js.core.Component",{ctor:function(b,c,d,e,i){if(f.isUndefined(g))try{g=a("js/core/Template")}catch(j){g=null}if(f.isUndefined(h))try{h=a("js/conf/Configuration")}catch(j){h=null}this.$eventDefinitions=[],this.$internalDescriptors=[],this.$xamlDefaults={},this.$xamlAttributes={};var k=this,l;while(k)k._$descriptor&&l!=k&&(this._cleanUpDescriptor(k._$descriptor),this.$internalDescriptors.unshift(k._$descriptor),f.extend(this.$xamlDefaults,this._getAttributesFromDescriptor(k._$descriptor))),k=k.base;c&&(this._cleanUpDescriptor(c),this.$xamlAttributes=this._getAttributesFromDescriptor(c)),this.$elements=[],this.$templates={},this.$configurations=[],this.$children=[],b=b||{},f.extend(b,this.$xamlAttributes,this.$xamlDefaults),this.callBase()},events:[],inject:{},_injectChain:function(){return this._generateDefaultsChain("inject")},_preinitialize:function(){this.callBase(),this._inject()},_inject:function(){var a=this._injectChain();if(f.keys(a).length>0){var b=this.$systemManager.$injection;if(!b)throw"injection not available in systemManager";for(var c in a)a.hasOwnProperty(c)&&(this.$[c]=b.getInstance(a[c]))}},addChild:function(a){if(!(a instanceof b))throw"only children of type js.core.Component can be added";this.$creationPolicy=="auto"&&a._initialize(this.$creationPolicy),a.$rootScope&&a.$.cid&&a.$rootScope.set(a.$.cid,a),a.$parent=this,this.$elements.push(a),g&&a instanceof g?this._addTemplate(a):h&&a instanceof h&&this._addConfiguration(a)},removeChild:function(a){if(!(a instanceof b))throw"only children of type js.core.Component can be removed";var c=this.$elements.indexOf(a);c!=-1&&(a.$parent=null,this.$elements.splice(c,1)),this.$templates.hasOwnProperty(a.$.name)&&delete this.$templates[a.$.name],c=this.$elements.indexOf(a),c!=-1&&this.$configurations.splice(c,1)},_addTemplate:function(a){if(!a.$.name)throw"template without name";this.$templates[a.$.name]=a},_addConfiguration:function(a){this.$configurations.push(a)},getTemplate:function(a){var b=this.$templates[a];return b?b:this.$parent&&this.$parent!=this?this.$parent.getTemplate(a):null},_initializeChildren:function(a){for(var b=0;b<a.length;b++)this.addChild(a[b])},_initializeAttributes:function(a){this.callBase(),this.$creationPolicy!="full"&&a.hasOwnProperty("creationPolicy")&&(this.$creationPolicy=a.creationPolicy,delete a.creationPolicy)},_initializeDescriptors:function(){var a=[],b;for(var c=0;c<this.$internalDescriptors.length;c++)b=this.$internalDescriptors[c],a=a.concat(this._getChildrenFromDescriptor(b,this));a=a.concat(this._getChildrenFromDescriptor(this.$descriptor)),this._initializeChildren(a),this._childrenInitialized(),this._initializeEventAttributes(this.$xamlDefaults,this),this._initializeEventAttributes(this.$xamlAttributes,this.$rootScope)},_cleanUpDescriptor:function(a){if(a&&a.childNodes){var b,c;for(var d=a.childNodes.length-1;d>=0;d--)b=a.childNodes[d],b.nodeType===3&&(c=b.textContent||b.text||b.data,(!c||c.trim().length===0)&&a.removeChild(b))}else console.warn("Descriptor not defined or not correct")},_isEventAttribute:function(a){return a.indexOf("on")==0},_isComponentEvent:function(a){for(var b=0;b<this.events.length;b++)if(a==this.events[b])return!0;return!1},_getEventTypeForAttribute:function(a){return this._eventAttributes[a]},_initializeEventAttributes:function(a,b){var c="";for(var d in a)if(a.hasOwnProperty(d)){var e=a[d];if(this._isEventAttribute(d)){if(!b[e])throw"Couldn't find callback "+e+" for "+d+" event";this.$eventDefinitions.push({name:d,scope:b,fncName:e}),c=d.substr(2),this._isComponentEvent(c)&&this.bind(c,b[e],b)}}},_initializeBindings:function(){var a=this.$,b;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this.$[c]=this.$bindingCreator.evaluate(b,this,c));for(var d=0;d<this.$elements.length;d++)this.$elements[d]._initializeBindings();this.callBase()},_createComponentForNode:function(a,b,c){if(!a)return null;b=b||{},c=c||this.$rootScope;var d=this.$systemManager.$applicationDomain;if(a.nodeType==1){var e=this.$systemManager.$applicationContext.getFqClassName(a.namespaceURI,this._localNameFromDomNode(a),!0),f=this.$systemManager.$applicationContext.getFqClassName(a.namespaceURI,this._localNameFromDomNode(a),!1);return this.$systemManager.$applicationContext.createInstance(e,[b,a,this.$systemManager,this,c],f)}if(a.nodeType==3||a.nodeType==4){var g=a.textContent?a.textContent:a.text;return a.textContent&&(a.textContent=g),this._createTextElement(a,c)}return null},createComponent:function(a,b){return b=b||[],this.$systemManager.$applicationContext.createInstance(a,[b,null,this.$systemManager,this,this.$rootScope])},_createTextElement:function(a,b){return this.$systemManager.$applicationContext.createInstance("js/core/TextElement",[null,a,this.$systemManager,this,b])},_getChildrenFromDescriptor:function(a,b){var c=[],d,e;if(a)for(var f=0;f<a.childNodes.length;f++)d=a.childNodes[f],e=this._createComponentForNode(d,null,b),e&&c.push(e);return c},_childrenInitialized:function(){},initialize:function(a){},_localNameFromDomNode:function(a){if(a.localName)return a.localName;var b=a.tagName.split(":");return b[b.length-1]}});return i}),define("js/core/Content",["require","js/core/Component"],function(a,b){return b.inherit("js.core.Content",{getChildren:function(){var b,c=[];for(var d=0;d<this.$elements.length;d++)b=this.$elements[d],b instanceof a("js/html/DomElement")&&c.push(b);return c}})}),define("js/html/DomElement",["require","js/core/EventDispatcher","js/core/Component","js/core/Content","js/core/Binding","inherit","underscore"],function(a,b,c,d,e,f,g){var h=/\s+/,i=["click","dblclick","keyup","keydown","change"],j,k={$classAttributes:[/^\$/,/^data/,/^xmlns/,/^on/,"cid",/^_/],ctor:function(a,b,c,d,e){this.$renderMap={},this.$children=[],this.$contentChildren=[],this.$domEventHandler={};var f=this;while(f)f.$classAttributes&&(this.$classAttributes=this.$classAttributes.concat(f.$classAttributes)),f=f.base;this.callBase(),b&&(this.$tagName||(this.$tagName=b.tagName),this.$namespace||(this.$namespace=b.namespaceURI))},_inject:function(){this.callBase();var a=this._injectChain();for(var b in a)a.hasOwnProperty(b)&&this.$classAttributes.push(b)},_initializeAttributes:function(a){this.callBase(),a.tagName&&(this.$tagName=a.tagName,delete a.tagName)},addChild:function(a){this.callBase(),a instanceof n||a.render?(this.$children.push(a),this.isRendered()&&this._renderChild(a)):a instanceof d&&this.$contentChildren.push(a)},removeChild:function(a){this.callBase();if(a instanceof n||a.render){this.isRendered()&&this._removeRenderedChild(a);var b=this.$children.indexOf(a);this.$children.splice(b,1)}},getPlaceHolder:function(a){for(var b=0;b<this.$children.length;b++)if(this.$children[b].$.name===a)return this.$children[b];var c;for(b=0;b<this.$children.length;b++)if(this.$children[b].getPlaceHolder){c=this.$children[b].getPlaceHolder(a);if(c)return c}return null},remove:function(){this.$parent&&this.$parent.removeChild(this)},getContentPlaceHolders:function(){j||(j=a("js/ui/ContentPlaceHolder"));var b=[],c;for(var d=0;d<this.$children.length;d++)c=this.$children[d],j&&c instanceof j?b.push(c):c instanceof n&&(b=b.concat(c.getContentPlaceHolders()));return b},findContent:function(a){var b,c;for(var e=0;e<this.$elements.length;e++){b=this.$elements[e];if(b instanceof d&&b.$.name===a)return b}for(e=0;e<this.$elements.length;e++){b=this.$elements[e];if(b.findContent){c=b.findContent(a);if(c)return c}}return null},render:function(){return this.$initialized||this._initialize(this.$creationPolicy),this.isRendered()?this.$el:(this.$renderedChildren=[],this.$systemManager.$document.createElementNS&&this.$namespace&&/^http/.test(this.$namespace)?this.$el=this.$systemManager.$document.createElementNS(this.$namespace,this.$tagName):this.$el=this.$systemManager.$document.createElement(this.$tagName),this._initializeRenderer(this.$el),this._renderChildren(this.$children),this._renderContentChildren(this.$contentChildren),this._renderAttributes(this.$),this._bindDomEvents(this.$el),this.$el)},_bindDomEvents:function(a){var b,c;for(var d=0;d<this.$eventDefinitions.length;d++)b=this.$eventDefinitions[d],c=b.name.substr(2),this._isComponentEvent(c)||this.addEventListener(c,b.scope[b.fncName],b.scope)},_initializeRenderer:function(a){},_renderChildren:function(a){var b;for(var c=0;c<a.length;c++)b=a[c],this._renderChild(b)},_renderContentChildren:function(a){var b;for(var c=0;c<a.length;c++){b=a[c];var d=b.get("ref"),e=this.getPlaceHolder(d);e&&e.set({content:b})}},_renderChild:function(a){if(g.isFunction(a.render)){var b=a.render();this.$renderedChildren.push(a),b&&this.$el.appendChild(b)}},_removeRenderedChild:function(a){if(this.isRendered()){var b;for(var c=this.$renderedChildren.length-1;c>=0;c--){b=this.$renderedChildren[c];if(a===b){this.$el.removeChild(b.$el),this.$renderedChildren.splice(c,1);return}}}},_clearRenderedChildren:function(){if(this.isRendered()){var a;for(var b=this.$renderedChildren.length-1;b>=0;b--)a=this.$renderedChildren[b],this.$el.removeChild(a.$el)}this.$renderedChildren=[]},_getIndexOfPlaceHolder:function(a){if(this.$layoutTpl){var b;for(var c=0;c<this.$layoutTpl.$children.length;c++){b=this.$layoutTpl.$children[c];if(placeHolderId==b.$cid)return c}}return-1},isRendered:function(){return typeof this.$el!="undefined"},_renderAttributes:function(a){var b;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this._renderAttribute(c,b))},_renderAttribute:function(a,b){var c=this.$renderMap[a],d=this.$previousAttributes[a];if(g.isUndefined(c)){var e=a.charAt(0).toUpperCase()+a.substr(1),f="_render"+e;c=this[f],g.isFunction(c)||(c=!1),this.$renderMap[a]=c}if(c!==!1)c.call(this,b,d);else{var h;for(var i=0;i<this.$classAttributes.length;i++){h=this.$classAttributes[i];if(h instanceof RegExp){if(h.test(a))return}else if(h==a)return}this._setAttribute(a,b)}},_setAttribute:function(a,b,c){g.isUndefined(b)||(c=c||this.$attributesNamespace[a],this.$el.setAttributeNS&&c?this.$el.setAttributeNS(c,a,b):this.$el.setAttribute(a,b))},_commitChangedAttributes:function(a){this.isRendered()&&this._renderAttributes(a)},destroy:function(){this.callBase();if(this.$children)for(var a=0;a<this.$children.length;a++)this.$children[a].destroy()},html:function(){return this.isRendered()||this.render(),this.$el.innerHTML}.on("change"),dom:function(a){return new m(a||this)},setChildIndex:function(a,b){b<0&&(b+=this.$children.length),b>=this.$children.length&&(b-=this.$children.length);var c=this.$children.indexOf(a);c!==b&&(this.$children.splice(c,1),this.$children.splice(b,0,a),this.isRendered()&&a.isRendered()&&this.$renderedChildren.length>1&&(this.$el.removeChild(a.$el),b<this.$el.childNodes.length?this.$el.insertBefore(a.$el,this.$el.childNodes[b]):this.$el.appendChild(a.$el)))},bringToFront:function(){this.$parent&&this.$parent.setChildIndex(this,this.$parent.$children.length-1)},sendToBack:function(){this.$parent&&this.$parent.setChildIndex(this,0)}},l={hasClass:function(a){return this.$el.className.split(" "+a+" ").length!=1},addClass:function(a){var b=a.split(h);if(!this.$el.className&&b.length===1)this.$el.className=a;else{var c=this.$el.className.split(h);for(var d=0;d<b.length;d++)c.indexOf(b[d])==-1&&c.push(b[d]);this.$el.className=c.join(" ")}},removeClass:function(a){if(!this.$el.className||this.$el.className.length===0)return;var b=a.split(h),c=this.$el.className.split(h);for(var d=0;d<b.length;d++){var e=c.indexOf(b[d]);e!=-1&&c.splice(e,1)}c.length===0?this.$el.removeAttribute("class"):this.$el.className=c.join(" ")},addEventListener:function(a,b,c){var d=this;this.bind(a,b,c);if(!this.$domEventHandler[a]){var e=this.$domEventHandler[a]=function(b){var c=new n.Event(b);try{d.trigger(a,c,d)}catch(c){}if(c.isPropagationStopped)return!1};this.$el.addEventListener?this.$el.addEventListener(a,e,!1):this.$el.attachEvent&&this.$el.attachEvent("on"+a,e)}},removeEventListener:function(a,b,c){this.unbind(a,b,c);var d=this._eventHandlers[a];if(d.length===0){var e=this.$domEventHandler[a];this.$el.removeEventListener?this.$el.removeEventListener(a,e,!1):this.$el.detachEvent&&this.$el.detachEvent("on"+a,e)}}},m=f.Base.inherit(g.extend({ctor:function(a){this.$el=a}},l)),n=c.inherit("js.html.DomElement",g.extend(k,l));return n.Event=b.Event.inherit({ctor:function(a){this.domEvent=a,this.callBase(a)},stopPropagation:function(){this.callBase();var a=this.domEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},preventDefault:function(){this.callBase();var a=this.domEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}}),n}),define("js/html/HtmlElement",["js/html/DomElement"],function(a){return a.inherit("js/html/HtmlElement",{defaults:{selected:undefined,selectable:undefined},_renderVisible:function(a){a===!0?this.removeClass("hide"):a===!1&&this.addClass("hide")},_renderHidden:function(a){typeof a!="undefined"&&this.set({visible:!a})},_renderSelected:function(a){a===!0?this.addClass("active"):a===!1&&this.removeClass("active")},_renderSelectable:function(a){if(a===!0){if(!this._onSelect){var b=this;this._onSelect=function(){b.set({selected:!b.$.selected})}}this.addEventListener("click",this._onSelect)}else this._onSelect&&this.removeEvent("click",this._onSelect)},_renderWidth:function(a){a&&(typeof a!="string"&&(a+="px"),this.$el.style.width=a)},_renderHeight:function(a){a&&(typeof a!="string"&&(a+="px"),this.$el.style.height=a)}})}),define("js/core/UIComponent",["js/html/HtmlElement"],function(a){return a.inherit("js.core.UIComponent",{defaults:{tagName:"div"}})}),function(a){var b=function(a){this.$context=a||{actions:[],vars:{}}},c=function(){return new b};b.prototype.seq=function(a,b){a instanceof Function&&(b=a,a=null);if(!b)throw"Sequence action not defined";var c=this;return this.$context.actions.push(function(d){var e=!1,f=!1,g=function(b,e,g){!b&&a&&(c.$context.vars[a]=e);if(f)return;f=!0,d(b,g)},h=function(a,b){g(a,b,!1)};h.vars=c.$context.vars;if(b.length){h.end=function(a,b){g(a,b,!0)};try{b.call(h,h)}catch(i){g(i,null)}}else{h.end=function(){e=!0};try{g(null,b.call(h),e)}catch(i){g(i,null,e)}}}),this};var d=function(a,b){if(!b)throw"Parallel action not defined";return function(c,d,e,f){var g=!1,h=function(b,d,g){!b&&a&&(e[a]=d),f(c,b,g)},i=function(a,b){h(a,b,!1)};i.vars=d.vars;if(b.length){i.end=function(a,b){h(a,b,!0)};try{b.call(i,i)}catch(j){h(j,null)}}else{i.end=function(){g=!0};try{h(null,b.call(i),g)}catch(j){h(j,null,g)}}}};b.prototype.par=function(a){if(arguments.length>1)return this.par(Array.prototype.slice.call(arguments)),this;var b=this,c,e;if(a){var f=[];if(a instanceof Array)for(c=0;c<a.length;c++){var g=a[c];f.push(new d(null,g))}else if(a instanceof Function)this.par([a]);else for(e in a)a.hasOwnProperty(e)&&f.push(new d(e,a[e]));f.length>0&&this.$context.actions.push(function(a){(function(a,c){var d={},e,f=function(e,f,g){var h;if(!c)return;if(f||g){var i=c;c=null,i(f,g)}else{var j=a.indexOf(e);if(!(j>=0&&j<a.length)){c("Parallel function returned which wasn't part of this parallel actions"),c=null;return}a.splice(j,1);if(a.length===0){for(h in d)d.hasOwnProperty(h)&&(b.$context.vars[h]=d[h]);c(null,!1),c=null}}},g=a.slice();for(e=0;e<g.length;e++){var h=g[e];h(h,b.$context,d,f)}})(f,a)})}return this},b.prototype.parEach=function(a,b){function e(a,e){c&&(e=a,a=null);var f;b.length>=2?f=function(a){b(e,a)}:f=function(){return b(e)},c?d.push(f):d[a]=f}a=a||[];if(b instanceof Function){var c=a instanceof Array,d=c?[]:{};if(c)for(var f=0;f<a.length;f++)e(a[f]);else for(var g in a)a.hasOwnProperty(g)&&e(g,a[g]);return this.par(d)}throw"2nd argument for parEach needs to be a function"},b.prototype.seqEach=function(a,b){function d(a){var d;b.length>=2?d=function(c){b(a,c)}:d=function(){return b(a)},c.seq(d)}a=a||[];if(a instanceof Array){if(b instanceof Function){var c=this;for(var e=0;e<a.length;e++)d(a[e]);return this}throw"2nd argument for parEach needs to be a function"}throw"values must be an array"},b.prototype.exec=function(a){function d(a,d){try{c(a,d)}catch(e){if(b.errorHandler)try{b.errorHandler(e)}catch(e){}}}function e(a){a<b.$context.actions.length?b.$context.actions[a](function(c,f){c||f?d(c,b.$context.vars):e(a+1)}):d(null,b.$context.vars)}var b=this,c=function(b,c){a&&a(b,c)};e(0)};if(typeof console!="undefined"&&console){var e=console.warn||console.log;e instanceof Function&&(b.prototype.errorHandler=function(a){a instanceof Error?e.call(console,[a.message,a.stack]):e.call(console,a)})}var f=a.flow;c.noConflict=function(){return a.flow=f,c},a.flow=c,a.Flow=b}(typeof exports=="undefined"?this:exports),define("flow",function(){return flow}),define("flow",function(){}),define("js/core/History",["js/core/Bindable","flow"],function(a,b){var c=/^#?!?\/?/,d,e=function(){};return a.inherit("js.core.History",{ctor:function(){this.callBase(),this.$routers=[],this.processUrl=!0,this.$history=[]},defaults:{interval:50},getFragment:function(){var a;return this.runsInBrowser()?a=decodeURIComponent(window.location.hash):a=this.$history[this.$history.length-1]||"",a.replace(c,"")},start:function(a,b){var c=this;this.$checkUrlFn=function(){c.checkUrl.apply(c,arguments)},this.runsInBrowser()?"onhashchange"in window?window.addEventListener?window.addEventListener("hashchange",this.$checkUrlFn,!1):window.attachEvent("onhashchange",this.$checkUrlFn):this.$checkUrlInterval=setInterval(this.$checkUrlFn,this.$.interval):this.$history.push(b||""),this.fragment=this.getFragment(),this.navigate(this.fragment,!0,!0,a),this.processUrl=!0},stop:function(){typeof window!="undefined"&&("onhashchange"in window?window.removeEventListener?window.removeEventListener("hashchange",this.$checkUrlFn,!1):window.detachEvent("onhashchange",this.$checkUrlFn):clearInterval(this.$checkUrlInterval))},addRouter:function(a){this.$routers.push(a)},checkUrl:function(a){if(this.processUrl){var b=this.getFragment();if(b==this.fragment)return!1;this.navigate(b,!0,!0,e)}this.processUrl=!0},triggerRoute:function(a,c){var d=[];for(var e=0;e<this.$routers.length;e++)d=d.concat(this.$routers[e].generateRoutingStack(a));d.length===0?(console.log("no route for '"+a+"' found."),c&&c()):b().seqEach(d,function(a,b){a(b)}).exec(c)},navigate:function(a,b,c,e){!e&&b instanceof Function&&(e=b,b=null),!e&&c instanceof Function&&(e=c,c=null);if(b==d||b==null)b=!0;if(c==d||c==null)c=!0;this.processUrl=!1,b?(this.runsInBrowser()?window.location.hash="/"+a:this.checkUrl(null),this.$history.push(a)):(this.runsInBrowser()&&window.location.replace("#/"+a),this.$history[this.$history.length-1]=a),this.fragment=a,c&&this.triggerRoute(a,e)}})}),define("js/core/Application",["js/core/UIComponent","js/core/History"],function(a,b){return a.inherit("js.core.Application",{$classAttributes:[/.+/],ctor:function(){this.history=new b,this.callBase()},initialize:function(){this.callBase()},_inject:function(){},_initializeDescriptors:function(){this.callBase(),a.prototype._inject.call(this)},start:function(a,b){a=a||{},this.$systemManager.$parameter=a,this.startHistory(b,a.initialHash)},startHistory:function(a,b){this.history.start(a,b)},render:function(a){var b=this.callBase(null);return a&&a.appendChild(b),b},toString:function(){return"js.core.Application"}})}),define("js/core/List",["js/core/Bindable","underscore"],function(a,b){return a.inherit("js.core.List",{ctor:function(a,b){this.$items=[],this.callBase(b),a&&this.add(a);var c=this;this.bind("add",function(){c.length=c.size()}),this.bind("remove",function(){c.length=c.size()}),this.length=this.size()},hasItems:function(){return this.$items.length>0}.on("add","remove"),push:function(a){this.$items.push(a),this.trigger("add",{item:a,index:this.$items.length-1})},pop:function(){return this.removeAt(this.$items.length)},shift:function(){return this.removeAt(0)},unshift:function(a){this.$items.unshift(a),this.trigger("add",{item:a,index:0})},add:function(c,d){d=d||{},b.defaults(d,{silent:!1,index:this.$items.length});var e=d.index;b.isArray(c)||(c=[c]);var f,g;for(var h=0;h<c.length;h++)f=c[h],f instanceof a&&f.bind("change",this._onItemChange,this),g=e+h,this.$items.splice(g,0,f),d.silent!==!0&&this.trigger("add",{item:f,index:g})},_onItemChange:function(a,b){this.trigger("change",{item:b,index:this.$items.indexOf(b)})},remove:function(a,c){b.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++)this.removeAt(this.$items.indexOf(a[d]),c)},removeAt:function(a,b){b=b||{};if(a>-1&&a<this.$items.length){var c=this.$items.splice(a,1);return b.silent!==!0&&this.trigger("remove",{item:c[0],index:a}),c[0]}return null},reset:function(a){this.$items=a,this.trigger("reset",{items:a})},sort:function(a){this.trigger("sort",{items:this.$items.sort(a),sortFnc:a})},clear:function(){this.reset([])},size:function(){return this.$items.length}.on("add","remove"),at:function(a){return a<this.$items.length&&a>=0?this.$items[a]:null},each:function(a,b){b=b||this;for(var c=0;c<this.$items.length;c++)a.call(b,this.$items[c],c)}})}),define("js/data/Entity",["require","js/core/Bindable","js/core/List"],function(a,b,c){var d=0,e,f=b.inherit("js.core.Entity",{ctor:function(a){this.$cid=++d,this._extendSchema(),this.callBase(a)},$schema:{},$context:null,$dependentObjectContext:null,$cacheInRootContext:!1,$isDependentObject:!0,_extendSchema:function(){var a=this.base;while(a instanceof f){var b=a.$schema;for(var c in b)b.hasOwnProperty(c)&&!this.$schema.hasOwnProperty(c)&&(this.$schema[c]=b[c]);a=a.base}},getContextForChildren:function(a){return a.prototype.$cacheInRootContext?this.$context.$datasource.getContext():this._isChildFactoryDependentObject(a)?(this.$dependentObjectContext||(this.$dependentObjectContext=this.$context.$datasource.createContext()),this.$dependentObjectContext):this.$context},_isChildFactoryDependentObject:function(a){return a&&a.prototype.$isDependentObject},parse:function(b,d,g){if(!e)try{e=a("js/data/Collection")}catch(h){}var i=this.$context.$datasource.getProcessorForModel(this);b=i.parse(b,d,g);var j=this.$schema;for(var k in j)if(j.hasOwnProperty(k)&&b.hasOwnProperty(k)){var l=b[k],m=j[k],n,o,p,q,r;if(m instanceof Array){if(m.length===1)n=m[0];else{if(m.length!==0)throw"Cannot determinate ModelFactory. Multiple factories defined for '"+k+"'.";this.log('ModelFactory for ListItem for "'+k+'" not defined',"warn"),n=f}if(!(n.prototype instanceof f))throw"Factory for type '"+k+"' isn't an instance of Entity";if(!(l instanceof Array||l===null))throw'Schema for type "'+k+'" requires to be an array';q=b[k]=new c,r=n===this.$context.$datasource.$entityFactory||n===this.$context.$datasource.$modelFactory?k:null;if(l)for(p=0;p<l.length;p++)o=this.getContextForChildren(n).createEntity(n,l[p].id,r),o.set(o.parse(l[p],d,g)),q.add(o)}else if(e&&m.classof(e)){r=m===this.$context.$datasource.$collectionFactory?k:m.prototype.$alias;var s=this.getContextForChildren(m);q=b[k]=s.createCollection(m,null,r),q.set(l);if(l instanceof Array||l===null)for(p=0;p<l.length;p++)o=s.createEntity(q.$modelFactory),o.set(o.parse(l[p],d,g)),q.add(o)}else{n=m||f;if(!(n.prototype instanceof f))throw"Factory for type '"+k+"' isn't an instance of Entity";r=n===this.$context.$datasource.$entityFactory||n===this.$context.$datasource.$modelFactory?k:null,b[k]=o=this.getContextForChildren(n).createEntity(n,this.$.id,r),o.set(o.parse(l,d,g))}}return b},prepare:function(a,b){return this.$},compose:function(a,b){return this.prepare(a,b)}});return f}),define("js/data/Model",["js/data/Entity","js/core/List","flow","underscore"],function(a,b,c,d){function h(a,b,c){d.each(a,function(a){if(a instanceof g){var d=b[a.$alias];d&&(d.found=!0,c.push(function(b){a.fetch({fetchSubModels:d.subModels},b)}))}else a instanceof Object&&h(a,b,c)})}function i(a,b,e,f){var i=function(a,b){f&&f(a,b,e)};if(a)i(a,b);else{var j=[];if(e.fetchSubModels&&e.fetchSubModels.length>0){var k=g.createSubModelLoadingChain(b,e.fetchSubModels);h(b.$,k,j);var l=d.filter(k,function(a){return!a.found});if(l.length>0){console.log(["requested submodel missing",l]),i("requested submodel missing",b);return}}c().par(j).exec(function(a){i(a,b)})}}var e={CREATED:0,LOADING:1,LOADED:2,ERROR:-1},f={NEW:0,CREATED:1,DELETED:-1},g=a.inherit("js.data.Model",{ctor:function(a){this.$modelClassName=this.constructor.name,this._fetch={callbacks:[],state:e.CREATED},this.callBase(a)},$isDependentObject:!1,save:function(a,b){try{var c=this._status();if(c!==f.NEW&&c!==f.CREATED)throw"status '"+c+"' doesn't allow save";this.$context.$datasource.saveModel(this,a,b)}catch(d){b&&b(d)}},prepare:function(a,b){return a=this.callBase(),b==="create"&&delete a.id,a},compose:function(a,b){var c=this.callBase(),d=this.$context.$datasource.getProcessorForModel(this,b);return d.compose(c,a,b)},fetch:function(a,b){a=a||{};var c=this;this._fetch.state===e.LOADING?this._fetch.callbacks.push(function(c,d){i(c,d,a,b)}):this._fetch.state==e.LOADED?i(null,this,a,b):(c._fetch.state=e.LOADING,this.$context.$datasource.loadModel(this,a,function(f,g){c._fetch.state=f?e.ERROR:e.LOADED,i(f,g,a,b),d.each(c._fetch.callbacks,function(a){a(f,g)})}))},remove:function(a,b){try{var c=this._status(),d=this;if(c!==f.CREATED)throw"status '"+c+"' doesn't allow delete";this.$context.$datasource.removeModel(this,a,function(a){a||d.set("id",!1),b(a)})}catch(e){b&&b(e)}},_status:function(){return this.$.id===!1?f.DELETED:this.$.id?f.CREATED:f.NEW}.onChange("id")});return g.createSubModelLoadingChain=function(a,b){var c={},e=/^([\w][\w.]*)(?:\/([\w][\w.]*))?$/;return d.each(b,function(a){var b=e.exec(a);if(b){var d=b[1],f=b[2],g=c[d];g||(g={type:d,found:!1,subModels:[]}),f&&g.subModels.push(f),c[d]=g}}),c},g.STATE=f,g.FETCHSTATE=e,g}),define("js/html/Input",["js/html/HtmlElement"],function(a){return a.inherit("js.html.Input",{$classAttributes:["updateOnEvent","checked"],defaults:{type:"text",checked:!1,updateOnEvent:"keyup"},_renderValue:function(a){a!==this.$el.value&&(this.$el.value=a)},_renderChecked:function(a){this.$el.checked=a},_bindDomEvents:function(){var a=this;this.$.type==="text"||this.$.type==="password"?this.addEventListener(this.$.updateOnEvent,function(b){a.set("value",a.$el.value)}):this.$.type==="checkbox"||this.$.type==="radio"?this.addEventListener("click",function(b){a.set("checked",a.$el.checked)}):this.$.type=="number"&&this.addEventListener(this.$.updateOnEvent,function(b){var c=parseInt(a.$el.value);isNaN(c)&&(c=a.$.value),a.set("value",c)}),this.callBase()}})}),define("js/conf/Configuration",["js/core/Component"],function(a){return a.inherit("js.core.Component",{})}),define("js/conf/Route",["js/conf/Configuration"],function(a){return a.inherit("js.conf.Route",{})}),define("js/core/Router",["js/core/Component","underscore","js/conf/Route"],function(a,b,c){return a.inherit("js.core.Router",{ctor:function(){this.$routes=[],this.callBase()},initialize:function(){this.callBase(),this.$.history?this.history=this.$.history:this.history=this.$systemManager.$application.history,this.history.addRouter(this)},_initializeChildren:function(a){this.callBase()},_childrenInitialized:function(){this.callBase();for(var a=0;a<this.$configurations.length;a++){var b=this.$configurations[a];b instanceof c&&this.addRoute(b.$)}},addRoute:function(){var a;arguments.length==2?a={route:arguments[0],fn:arguments[1]}:a=arguments[0],a.onexec&&(a.fn=this.$rootScope[a.onexec]),b.defaults(a,{name:null,route:null,fn:null}),a.route&&!(a.route instanceof RegExp)&&(a.route=new RegExp(a.route));if(!a.fn||!a.route)throw"fn and route required";this.$routes.push(a)},generateRoutingStack:function(a){function f(a,f){c.push(function(c){var g=f.shift(),h={callback:c,router:e,params:b.clone(f),fragment:g,end:function(){c.end()},navigate:function(a,d,f){b.isUndefined(d)&&(d=!1),e.navigate(a,d,f,c)}};f.unshift(h);if(a.fn._async)try{a.fn.apply(d,f)}catch(i){c(i)}else try{c(null,a.fn.apply(d,f))}catch(i){c(i)}})}var c=[],d=this.$rootScope,e=this;for(var g=0;g<this.$routes.length;g++){var h=this.$routes[g],i=h.route.exec(a);i&&f(h,i)}return c},executeRoute:function(a,c){for(var d=0;d<this.$routes.length;d++){var e=this.$routes[d],f=e.route.exec(a);if(f){var g=function(a,b){c&&c(a,b)};f.shift();var h={callback:g,router:this,params:b.clone(f),fragment:a};f.unshift(h);var i=this.$rootScope;if(e.fn._async)e.fn.apply(i,f);else try{g(null,e.fn.apply(i,f))}catch(j){g(j)}return!0}}return!1},navigate:function(a,b,c,d){return this.history.navigate(a,b,c,d)}})}),define("js/core/I18n",["require","js/core/Component","underscore"],function(a,b,c){return b.inherit("js.core.I18n",{defaults:{path:"app/locale",locale:null,suffix:".json",translations:{}},initialize:function(){this.callBase(),this.loadLocale(this.$.locale)},_commitChangedAttributes:function(a){a.locale&&this.loadLocale(a.locale)},loadLocale:function(b,c){if(!b)throw"locale not defined";var d=this;a(["json!"+this.$.path+"/"+this.$.locale],function(a){d.set({translations:a}),c&&c()})},translate:function(){var a=Array.prototype.slice.call(arguments),b=a.shift(),d;c.isNumber(b)&&(d=b!==1,b=a.shift()),d&&(b+="_plural");var e=this.$.translations[b]||"";for(var f=0;f<a.length;f++)e=e.split("%"+f).join(a[f]);return e}.onChange("translations")})}),define("js/core/Script",["js/core/Element"],function(Element){return Element.inherit("js.core.Script",{evaluate:function(imports){var textContent=this._getTextContentFromDescriptor(this.$descriptor),fn=eval("this.javascript = ("+textContent+")");return fn.apply(this,imports)}})}),define("js/ui/View",["js/html/HtmlElement","js/core/Content","underscore"],function(a,b,c){return a.inherit({defaults:{tagName:"div"},render:function(){var a=this.$templates.layout;if(a){var b=a.createComponents({},this,this);this._initializeLayoutChildren(b)}return this.callBase()},_initializeLayoutChildren:function(a){for(var b=0;b<a.length;b++)a[b].$rootScope=this,this.addChild(a[b])},_renderChild:function(a){this.callBase();if(a instanceof b){var c=a.get("ref");if(c){var d=this.getPlaceHolder(c);d&&d.set({content:a})}}},_renderLayoutClass:function(a,b){c.each(this.$renderedChildren,function(c){b&&c.removeClass(b),a&&c.addClass(a)})},_renderComponentClass:function(a,b){b&&this.removeClass(b),a&&this.addClass(a)},_renderClass:function(a){a&&this.addClass(a)},_renderTemplateToPlaceHolder:function(a,b,c){this.$renderedPlaceholders=this.$renderedPlaceholders||{};var d=this.$renderedPlaceholders[b];if(!d){var e=this.getTemplate(a);if(e){d=e.createComponents(c)[0];var f=this.getPlaceHolder(b);f&&(f.set({content:d}),this.$renderedPlaceholders[b]=d)}}else d.set(c)},_renderId:function(a){a&&this.$el.setAttribute("id",a)}})}),define("js/core/Template",["js/core/Component"],function(a){return a.inherit("js.core.Template",{_initializeDescriptors:function(){this._cleanUpDescriptor(this.$descriptor),this._childrenInitialized()},createComponents:function(a,b,c){c=c||this.$rootScope,b=b||this.$parentScope;var d=this._getChildrenFromDescriptor(this.$descriptor,null,c);for(var e=0;e<d.length;e++)d[e].$parentScope=b,d[e].set(a),d[e]._initialize("auto",!0);return d}})}),define("js/ui/ItemsView",["js/ui/View","js/core/Template","js/core/List","underscore"],function(a,b,c,d){return a.inherit({defaults:{tagName:"div",items:null,itemKey:"item",indexKey:"index"},$classAttributes:["itemKey","indexKey"],hasItems:function(){return this.$.items?this.$.items.length:0}.on("items"),render:function(){return this.isRendered()||(this.$renderedItems=[]),this.callBase()},_renderItems:function(a,b){b&&b instanceof c&&(b.unbind("sort",this._onSort,this),b.unbind("reset",this._onReset,this),b.unbind("add",this._onItemAdd,this),b.unbind("remove",this._onItemRemove,this)),a instanceof c?(a.bind("sort",this._onSort,this),a.bind("reset",this._onReset,this),a.bind("add",this._onItemAdd,this),a.bind("remove",this._onItemRemove,this),this._innerRenderItems(a.$items)):d.isArray(a)&&this._innerRenderItems(a)},_onSort:function(a){if(this.isRendered()){var b,c;for(var d=0;d<a.$.items.length;d++)b=a.$.items[d],c=this.getComponentForItem(b),this.$el.removeChild(c.$el),this.$el.appendChild(c.$el)}},_onReset:function(a){this._innerRenderItems(a.$.items)},_onItemAdd:function(a){this._innerRenderItem(a.$.item,a.$.index)},_onItemRemove:function(a){this._removeRenderedItem(a.$.item)},_innerRenderItems:function(a){if(this.$renderedItems){var b;for(var c=this.$renderedItems.length-1;c>=0;c--)b=this.$renderedItems[c],this.removeChild(b.component),b.component.destroy()}this.$renderedItems=[];for(var d=0;d<a.length;d++)this._innerRenderItem(a[d],d)},_createComponentForItem:function(a,b){var c={};c[this._getItemKey()]=a,c[this._getIndexKey()]=b;var d=this.$templates.item.createComponents(c)[0];return this.$renderedItems.push({item:a,component:d}),d},_innerRenderItem:function(a,b){this.addChild(this._createComponentForItem(a,b))},_getItemKey:function(){return"$"+this.$.itemKey},_getIndexKey:function(){return"$"+this.$.indexKey},_removeRenderedItem:function(a){var b;for(var c=0;c<this.$renderedItems.length;c++){b=this.$renderedItems[c];if(b.item===a){this.removeChild(b.component),this.$renderedItems.splice(c,1),b.component.destroy();return}}},getComponentForItem:function(a){var b;for(var c=0;c<this.$renderedItems.length;c++){b=this.$renderedItems[c];if(b.item===a)return b.component}return null}})}),define("js/core/Injection",["js/core/Component","underscore"],function(a,b){function c(a,b){return a==b||a.prototype instanceof b}return a.inherit("js.core.Injection",{ctor:function(a,b,c,d,e){return c.$injection||(this.callBase(),this.$singletonInstanceCache=[],this.$factories=[],c.$injection=this),c.$injection},_initializeChildren:function(a){this.callBase()},_childrenInitialized:function(){this.callBase();for(var a=0;a<this.$configurations.length;a++){var b=this.$configurations[a];this.addFactory(b.$)}},getInstance:function(a){var d;if(b.isString(a)){if(this.$singletonInstanceCache.hasOwnProperty(a))return this.$singletonInstanceCache[a]}else{for(var e=0;e<this.$singletonInstanceCache.length;e++){d=this.$singletonInstanceCache[e];if(d instanceof a)return d}for(var f=0;f<this.$factories.length;f++){var g=this.$factories[f];if(c(g.factory,a)){d=new g.factory;if(d instanceof a)return g.singleton&&this.addInstance(d),d}}}throw"requested injection type not found"},addChild:function(a){this.callBase(a),this.addInstance(a)},addFactory:function(a){a instanceof Function&&(a={factory:a}),b.defaults(a,{type:null,factory:null,singleton:!1});if(!a.factory){var c=this.$systemManager.$applicationDomain.getDefinition(a.type);if(!c)throw"factory for type '"+a.type+"' not found";a.factory=c}this.$factories.push(a)},addInstance:function(a,b){arguments.length==1&&(b=a,a=null);if(b instanceof Function)throw"got a factory instead of an instance";a?this.$singletonInstanceCache[a]=b:this.$singletonInstanceCache.push(b)}})}),define("js/ui/ContentPlaceHolder",["js/ui/View"],function(a){return a.inherit({$classAttributes:["name"],_renderContent:function(a){this._clearRenderedChildren(),a&&this._renderChildren(a.getChildren())}})}),define("js/ui/TextWrapper",["js/ui/View"],function(a){var b=function(a){var b=[],c,d=[],e,f=0;for(var g=0;g<a.length;g++)e=a.charAt(g),e=="["&&d.length===0?(c={},c.start=g,d.push(g)):e=="|"?f=g:e=="]"&&d.length>0&&f>0&&(c.index=parseInt(a.substring(f+1,g)),c.end=g,c.text=a.substring(c.start+1,f),b.push(c),d.pop());return b};return a.inherit({defaults:{tagName:"span"},_getChildrenFromDescriptor:function(a){return[]},_renderChildren:function(){},_renderContentChildren:function(){},_renderString:function(a,c){for(var d=0;d<this.$el.childNodes.length;d++)this.$el.removeChild(this.$el.childNodes[d]);if(a){var e=b(a),f,g=-1;for(var h=0;h<e.length;h++){f=e[h],f.start>g&&this.$el.appendChild(this.$systemManager.$document.createTextNode(a.substring(g+1,f.start))),g=f.end,this.$viewMap||(this.$viewMap={});var i=f.index+":"+h,j=this.$viewMap[i];j||(j=this._createComponentForNode(this.$descriptor.childNodes[f.index]),j&&(j.$parentScope=this.$parentScope,j.$rootScope=this.$rootScope,this.$viewMap[i]=j)),j?(j.set("$text",f.text),j._initialize("auto",!0),j.isRendered()||j.render(),this.$children.push(j),this.$el.appendChild(j.$el)):this.$el.appendChild(this.$systemManager.$document.createTextNode(f.text))}g<a.length&&this.$el.appendChild(this.$systemManager.$document.createTextNode(a.substr(g+1)))}}})}),define("js/data/DataView",["js/core/Component","js/core/List","underscore"],function(a,b,c){return a.inherit("js.data.DataView",{defaults:{filterFnc:function(a,b,c){return!0}},initialize:function(){this.$.list=new b,this.bind("baseList","add",this._onItemAdded,this),this.bind("baseList","remove",this._onItemRemoved,this),this.bind("baseList","change",this._onItemChanged,this),this.bind("baseList","reset",this._onReset,this),this.bind("baseList","sort",this._onSort,this),this.$.baseList&&this.$.baseList instanceof b&&this._innerReset(this.$.baseList.$items)},_onItemChanged:function(){},_onReset:function(a){this._innerReset(a.items)},_onSort:function(a){this.$.list.sort(a.sortFnc)},_innerReset:function(a){},destroy:function(){this.unbind("baseList","add",this._onItemAdded,this),this.unbind("baseList","remove",this._onItemRemoved,this),this.unbind("baseList","change",this._onItemChanged,this),this.unbind("baseList","reset",this._onReset,this),this.unbind("baseList","sort",this._onSort,this),this.callBase()}})}),define("js/data/FilterDataView",["js/data/DataView"],function(a){return a.inherit("js.data.FilterListView",{initialize:function(){this.callBase(),this.bind("change:filter",this._onFilterChanged,this),this.bind("filterFnc",this._onFilterChanged,this)},_onFilterChanged:function(){this._innerReset(this.$.baseList.$items)},_onItemAdded:function(a){var b=this._filterItem(a.$.item,a.index);b===!0&&this.$.list.add(a.$.item,a.index)},_onItemRemoved:function(a){this.$.list.remove(a.$.item,a.$.index)},_onItemChanged:function(a){var b=this._filterItem(a.$.item,a.$.index),c=_.include(this.$.list.$items,a.$.item);c&&b===!1?this.$.list.remove(a.$.item,a.$.index):!c&&b===!0&&this.$.list.add(a.$.item,a.$.index)},_innerReset:function(a){var b=[],c;for(var d=0;d<a.length;d++)c=a[d],this._filterItem(c,d)===!0&&b.push(c);this.$.list.reset(b)},_filterItem:function(a,b){return this.$.filterFnc?this.$.filterFnc.call(this,a,b,this.$.list):!0}})}),define("js/data/Collection",["require","js/core/List","js/data/Model","flow","underscore"],function(a,b,c,d,e){var f=0,g={CREATED:0,LOADING:1,LOADED:2,ERROR:-1},h=b.inherit("js.data.Collection",{$modelFactory:c,ctor:function(b,c){c=c||{},this.callBase(b),this.$cid=++f,e.defaults(c,{rootCollection:null,pageSize:null,queryParameters:{},factory:this.$modelFactory||a("js/data/Model"),type:null}),this.$itemsCount=null,this.$queryCollectionsCache={},this.$pageCache=[],this.$options=c},getRootCollection:function(){return this.$options.rootCollection?this.$options.rootCollection:this},createQueryCacheKey:function(a){a=a||{};var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return b.sort(),b.length==0?"root":b.join("&")},createQueryCollection:function(a){var b={queryParameter:a,rootCollection:this.getRootCollection()};return e.defaults(b,this.$options),new h(null,b)},fetch:function(a,b){function e(e){function g(b){f.push(function(d){c.fetchPage(b,a,d)})}var f=[];for(var h=0;h<e;h++)g(h);d().par(f).exec(function(a){b&&b(a,c)})}a=a||{};var c=this;if(!this.$options.pageSize)this.fetchPage(0,a,b);else{var f=this.pageCount();isNaN(f)?this.fetchPage(0,a,function(a){a?b&&b(a,c):(f=c.pageCount(),isNaN(f)?b&&b("Count for collection couldn't be fetched.",c):e(f))}):e(f)}},pageCount:function(){return this.$itemsCount?Math.ceil(this.$itemsCount/this.$options.pageSize):NaN},getContextForChildren:function(a){return a.prototype.$cacheInRootContext?this.$context.$datasource.getContext():this.$context},parse:function(a,b){if(a instanceof Array){var c=this.$modelFactory,d=c===this.$context.$datasource.$entityFactory||c===this.$context.$datasource.$modelFactory?b:this.$alias;for(var e=0;e<a.length;e++){var f=a[e],g=this.getContextForChildren(c).createEntity(c,f.id,d,b);g.set(g.parse(f)),a[e]=g}return a}throw"data has to be an array"},createItem:function(a,b){return this.getContextForChildren(this.$modelFactory).createEntity(this.$modelFactory,a,b)},fetchPage:function(a,b,c){if(a<0)throw"pageIndex must be >= 0";var d=this.$pageCache[a];d||(d=this.$pageCache[a]=new i(null,this.getRootCollection(),a));var e=this;d.fetch(b,function(d,f){!d&&!f.itemsInsertedIntoCollection&&(f.itemsInsertedIntoCollection=!0,e.add(f.$items,{index:(a||0)*e.$options.pageSize})),c&&c(d,f,b)})},find:function(a){var b=this.createQueryCacheKey(a);return this.$queryCollectionsCache.hasOwnProperty(b)||(this.$queryCollectionsCache[b]=this.createQueryCollection(a)),this.$queryCollectionsCache[b]}}),i=h.Page=b.inherit({ctor:function(a,b,c){if(!b.$options.pageSize&&c!==0)throw"Cannot create page for index '"+c+"' with pageSize '"+b.options.pageSize+"'";var d=b.$options;d.pageSize&&(this.$offset=c*d.pageSize,this.$limit=d.pageSize),this.$pageIndex=c,this.$collection=b,this.callBase(a),this._fetch={callbacks:[],state:g.CREATED}},parse:function(a,b){return this.$collection.parse.call(this.$collection,a,b)},fetch:function(a,b){function f(b,c,e){var f=function(b,c){e&&e(b,c,a)};a.fetchModels||a.fetchSubModels?d().parEach(c.$items,function(b,c){b.fetch({fetchSubModels:a.fetchSubModels},c)}).exec(function(a){f(a,c)}):f(b,c)}a=a||{};var c=this;this._fetch.state===g.LOADING?this._fetch.callbacks.push(function(a,c){f(a,c,b)}):this._fetch.state==g.LOADED?f(null,this,b):(c._fetch.state=g.LOADING,this.$collection.$context.$datasource.loadCollectionPage(this,a,function(a,d){c._fetch.state=a?g.ERROR:g.LOADED,f(a,d,b),e.each(c._fetch.callbacks,function(b){b(a,d)})}))}});return h.of=function(b){if(b instanceof Function)return h.inherit(h.prototype.constructor.name+"["+b.prototype.constructor.name+"]",{$modelFactory:b});if(e.isString(b))return h.inherit(h.prototype.constructor.name+"["+b+"]",{$alias:b,$modelFactory:c||a("js/data/Model")});throw"Cannot create Collection of '"+b+"'."},h}),define("js/data/DataSource",["require","js/core/Component","js/core/Base","js/data/Collection","underscore","js/data/Model","js/data/Entity","js/core/List","flow","JSON"],function(a,b,c,d,e,f,g,h,i,j){var k,l=c.inherit("js.data.DataSource.Context",{defaults:{collectionPageSize:null},ctor:function(a,b,c){this.callBase(),this.$datasource=a,this.$properties=b,this.$parent=c,this.$cache={}},addEntityToCache:function(a){this.$cache[l.generateCacheIdFromEntity(a)]=a},addCollectionToCache:function(a){this.$cache[l.generateCacheIdFromCollection(a)]=a},getInstanceByCacheId:function(a){return this.$cache[a]},getPathComponents:function(){return[]},createEntity:function(a,b,c){if(e.isFunction(a)){var d=a.prototype.constructor.name;c=c||(a.classof(f)?this.$datasource.getAliasForModelClassName(d):d);if(a.classof(f)&&!c)throw"Alias for '"+d+"' not found";var g;return b&&(g=this.getInstanceByCacheId(l.generateCacheIdForEntity(c,b))),g||(g=new a({id:b}),g.$context=this,g.$alias=c,this.addEntityToCache(g)),g}throw"Factory has to be a function"},createCollection:function(a,b,c){b=b||{};if(e.isFunction(a)){var d=a.prototype.constructor.name;c=c||this.$datasource.getAliasForCollectionClassName(d);if(!c)throw"Alias for '"+d+"' not found";e.defaults(b,{factory:a,type:c});var f=this.getInstanceByCacheId(l.generateCacheIdForCollection(c));return f||(f=new a(null,b),f.$context=this,f.$alias=c,this.addCollectionToCache(f)),f}throw"Factory has to be a function"}});l.generateCacheIdForCollection=function(a){return a},l.generateCacheIdForEntity=function(a,b){return a+"_"+b},l.generateCacheIdFromEntity=function(a){return l.generateCacheIdForEntity(a.$alias,a.$.id)},l.generateCacheIdFromCollection=function(a){return l.generateCacheIdForCollection(a.$alias)};var m=c.inherit("js.data.DataSource.Processor",{ctor:function(a){if(!a)throw"dataSource is required for Processor";this.$datasource=a},compose:function(a,b,c){return this._composeObject(a,b,c)},_composeObject:function(a,b,c){var d={};for(var e in a)if(a.hasOwnProperty(e)){var f=this._getCompositionValue(a[e],b,c);f!==k&&(d[e]=f)}return d},_getCompositionValue:function(a,b,c){if(a instanceof f)return this._composeSubModel(a,b,c);if(a instanceof d)return this._composeCollection(a,b,c);if(a instanceof g)return a.compose(b,c);if(a instanceof h){var e=[],i=this;return a.each(function(a){e.push(i._getCompositionValue(a,b,c))}),e}return a instanceof Object?this._composeObject(a):a},_composeSubModel:function(a,b,c){return a.compose(b,c)},_composeCollection:function(a,b,c){return k},parse:function(a,b,c){return a},saveSubModels:function(a,b,c){c()},getSubModelsForModel:function(a){function c(d){if(d===a)return;if(e.indexOf(b,d)!==-1)return;if(d instanceof f){b.push(d);return}for(var g in d)if(d.hasOwnProperty(g)){var i=d[g];if(i instanceof Array)for(var j=0;j<i.length;j++)c(i[j]);else i instanceof h?i.each(function(a){c(a)}):i instanceof Object&&c(i)}}var b=[];return c(a.$),b}}),n=b.inherit("js.data.DataSource",{ctor:function(){this.$configuredTypes=[],this.$contextCache={},this.$formatProcessors=[],this.callBase(),this.initializeFormatProcessors(),this.initializeProcessors()},$processors:{},$modelFactory:f,$entityFactory:g,$collectionFactory:d,$defaultProcessorFactory:m,$defaultProcessor:null,initializeFormatProcessors:function(){},initializeProcessors:function(){this.$defaultProcessor=new this.$defaultProcessorFactory(this);for(var a in this.$processors)this.$processors.hasOwnProperty(a)&&this.$processors[a]instanceof Function&&(this.$processors[a]=new this.$processors[a](this))},_childrenInitialized:function(){this.callBase();for(var a=0;a<this.$configurations.length;a++){var b=this.$configurations[a];this.addTypeConfiguration(b)}},getAliasForModelClassName:function(a){for(var b=0;b<this.$configuredTypes.length;b++){var c=this.$configuredTypes[b];if(c.$.modelClassName===a)return c.$.alias}return null},getAliasForCollectionClassName:function(a){for(var b=0;b<this.$configuredTypes.length;b++){var c=this.$configuredTypes[b];if(c.$.collectionClassName===a)return c.$.alias}return null},addTypeConfiguration:function(a){if(!a.$.modelClassName&&!a.$.alias)throw"neither modelClassName nor alias defined";a.$.modelClassName&&!a.$.alias&&(a.$.alias=a.$.modelClassName.split(".").pop()),a.$.modelClassName||(a.$.modelClassName="js.data.Model"),this.$configuredTypes.push(a)},getFqClassName:function(a){for(var b=0;b<this.$configuredTypes.length;b++){var c=this.$configuredTypes[b];if(c.$.alias==a)return c.$.modelClassName}},getContext:function(a,b){var c=this.createContextCacheId(a,b?b.$properties:null);return this.$contextCache.hasOwnProperty(c)||(this.$contextCache[c]=this.createContext(a,b)),this.$contextCache[c]},root:function(){return this.getContext()},createContext:function(a,b){return new l(this,a,b)},createContextCacheId:function(a,b){var c=[];return e.each(e.extend({},b,a),function(a,b){c.push(b+"="+a)}),c.sort(),c.length==0?"root":c.join("&")},createEntity:function(a,b,c,d){return d=d||this.getContext(),d.createEntity(a,b,c)},createCollection:function(a,b,c,d){return d=d||this.getContext(),d.createCollection(a,b,c)},resolveReferences:function(a,b,c,d){d&&d("Abstract method",b)},loadModel:function(a,b,c){c&&c("Abstract method",a)},loadCollectionPage:function(a,b,c){c&&c("Abstact method loadCollectionPage",a)},saveModel:function(a,b,c){c&&c("Abstract method saveModel",a)},removeModel:function(a,b,c){c&&c("Abstract method removeModel",a)},getConfigurationForModelClass:function(a){for(var b=0;b<this.$configuredTypes.length;b++){var c=this.$configuredTypes[b];if(c.$.modelClassName===a)return c}return null},getConfigurationByAlias:function(a){for(var b=0;b<this.$configuredTypes.length;b++){var c=this.$configuredTypes[b];if(c.$.alias===a)return c}return null},getProcessorForModel:function(a,b){if(a){var c;a.constructor===this.$modelFactory?c=this.getConfigurationByAlias(a.$alias):c=this.getConfigurationForModelClass(a.$modelClassName);if(c&&c.$.processor){var d=c.$.processor;if(this.$processors[d])return this.$processors[d];throw"Processor for '"+d+"' not an instance of js.data.DataSource.Processor."}}return this.$defaultProcessor},getFormatProcessor:function(a){return this.$formatProcessors[0]},update:function(a,b){},find:function(a,b){}});return n.FormatProcessor=c.inherit("js.data.DataSource.FormatProcessor",{serialize:function(a){throw"abstract method"},deserialize:function(a){throw"abstract method"}}),n.JsonFormatProcessor=n.FormatProcessor.inherit("js.data.DataSource.JsonFormatProcessor",{serialize:function(a){return j.stringify(a)},deserialize:function(a){return j.parse(a)}}),n.Context=l,n.Processor=m,n.ACTION={LOAD:"load",CREATE:"create",UPDATE:"update",DELETE:"delete"},n.IdGenerator={genId:function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})},n}),define("js/data/LocalStorageDataSource",["js/data/DataSource","js/data/Model","flow"],function(a,b,c){var d=new a.JsonFormatProcessor;return a.inherit("js.data.LocalStorageDataSource",{defaults:{name:"default"},ctor:function(){this.callBase(),this.$storage=this._getStorage();if(!this.$storage)throw"Storage not available";var a=this.$storage.getItem(this.$.name);this.$data=a&&this.getFormatProcessor(null).deserialize(a)||{}},getFormatProcessor:function(a){return d},getPathComponentsForModel:function(a){if(a){var b=this.getConfigurationByAlias(a.$alias);if(b)return[b.$.path]}return null},getPathForAlias:function(a){var b,c;for(c=0;c<this.$configuredTypes.length;c++){b=this.$configuredTypes[c];if(b.$.alias==a)return b.$.path}return null},_getStorage:function(){return typeof window!="undefined"&&window.localStorage?window.localStorage:null},_getCollectionData:function(a,b){if(!a){callback("path for model unknown",null,options);return}var c=[];return b&&(c=c.concat(b)),c=c.concat(a),this.$data[c.join(":")]||{}},loadCollectionPage:function(a,b,c){c=c||function(){};var d=a.$collection.$options.path?a.$collection.$options.path:this.getPathForAlias(a.$collection.$alias),e=a.$collection.$context.getPathComponents(),f=[],g=this._getCollectionData(d,e);for(var h in g)g.hasOwnProperty(h)&&f.push(this.$data[h]);f=a.parse(f),a.add(f),c(null,a,b)},saveModel:function(d,e,f){f=f||function(){};var g=a.ACTION.UPDATE;d._status()===b.STATE.NEW&&(g=a.ACTION.CREATE);var h=this.getProcessorForModel(d,e),i=this.getFormatProcessor(g),j=this;c().seq(function(a){h.saveSubModels(d,e,a)}).seq(function(c){var f=d.compose(g,e);d._status()===b.STATE.NEW&&(f.id=a.IdGenerator.genId()),j.$data[f.id]=f;if(g===a.ACTION.CREATE){var h=j.getPathComponentsForModel(d);if(!h){c("path for model unknown");return}var i=[];i=i.concat(d.$context.getPathComponents()),i=i.concat(h);var k=j.$data[i.join(":")]||{};k[f.id]=!0,j.$data[i.join(":")]=k}j._saveStorage(),d.set("id",f.id),c()}).exec(function(a){f(a,d,e)})},loadModel:function(b,c,d){d=d||function(){};var e=this.getFormatProcessor(a.ACTION.LOAD),f;if(!b.$.id){d("Model has no id");return}f=this.$data[b.$.id];if(!f){d("Could not find model");return}f=b.parse(f),b.set(f),d(null,b,c)},removeModel:function(a,b,c){c=c||function(){};var d;if(!a.$.id){c("Model has no id");return}delete this.$data[a.$.id];var e=this._getCollectionData(this.getPathComponentsForModel(a));e&&delete e[a.$.id],this._saveStorage(),c(null,a,b)},_saveStorage:function(){this.$storage.setItem(this.$.name,this.getFormatProcessor(null).serialize(this.$data))}})}),define("js/html/a",["js/html/HtmlElement"],function(a){var b=/^(([^:]+:\/\/)|(javascript:))/i,c=/^#/,d=/^#?(.*)$/;return a.inherit("js.html.a",{defaults:{tagName:"a",target:null,href:null},_renderHref:function(a){a=a||"javascript:void(0);",this.$.target!=="external"&&!b.test(a)&&this.$.target!=="_blank"&&(c.test(a)||(a="#"+a),this.runsInBrowser()||(a=a.replace(d,"#!$1"))),this.$el.setAttribute("href",a)},_renderTarget:function(a){a&&a!=="external"&&this.$el.setAttribute("target",a)}})}),function(a,b,c,d,e){function n(a){function b(){}return b.prototype=a,new b}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var f;Function.prototype.async=function(){return this._async=!0,this};var g=/^(xaml!)?(.+?)(\.xml)?$/,h=function(a,b){this.$from=a,this.$to=b},i={"http://www.w3.org/1999/xhtml":"js.html","http://www.w3.org/2000/svg":"js.svg"},j=[new h(/^js\/html\/(a)$/,"js/html/a"),new h(/^js\/html\/(input)$/,"js/html/Input"),new h(/^js\/html\/(select)$/,"js/html/Select"),new h(/^js\/html\/(textarea)$/,"js/html/TextArea"),new h(/^js\/html\/(option)$/,"js/html/Option"),new h(/^js\/html\/(.+)$/,"js/html/HtmlElement"),new h(/^js\/svg\/svg$/,"js/svg/Svg"),new h(/^js\/svg\/(.+)$/,"js/svg/SvgElement")];typeof JSON!="undefined"?c("JSON",[],function(){return JSON}):b.config({paths:{JSON:"js/lib/json2"},shim:{JSON:{exports:"JSON"}}}),b.config({paths:{json:"js/plugins/json"}});var k={createApplicationContext:function(a,d,e){d=d||{};var h=function(d){d.xamlClasses=d.xamlClasses||[],d.namespaceMap=d.namespaceMap||i,d.rewriteMap=d.rewriteMap||j;var h=b.config(d),k=new p(h,d);c("rAppid",function(){return k}),typeof JSON!="undefined"&&c("JSON",function(){return JSON}),h(["inherit","underscore"],function(b,c){f=c;if(b&&c)if(a){var d=g.exec(a);d?a="xaml!"+d[2]:a=a.replace(/\./g,"/"),h([a],function(a){k.$applicationFactory=a,e(null,k)},function(a){e(a)})}else e(null,k);else e("inherit or underscore missing")})};Object.prototype.toString.call(d)=="[object String]"?b(["json!"+d],function(a){h(a)}):h(d)},bootStrap:function(a,b,c){k.createApplicationContext(a,b,function(a,b){a||!d?c(a||"target document missing"):b.createApplicationInstance(d,c)})},rewriteMapEntry:h,createQueryString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},ajax:function(a,b,c){var d={url:a};f.extend(d,k.ajaxSettings,b);if(d.data&&!f.isString(d.data))throw"data must be a string";d.hasContent=!/^(?:GET|HEAD)$/.test(d.type),d.queryParameter&&f.keys(d.queryParameter).length>0&&(d.url+=/\?/.test(d.url)?"&":"?"+this.createQueryString(d.queryParameter));var e=d.xhr();e.open(d.type,d.url,d.async),d.hasContent&&d.contentType!==!1&&(e.setRequestHeader("Content-Type",d.contentType),e.setRequestHeader("Content-Length",d.data?d.data.length.toString():"0"));try{for(var g in d.headers)d.headers.hasOwnProperty(g)&&e.setRequestHeader(g,d.headers[g])}catch(h){}e.send(d.data);var i=function(a,b){var d;i&&(b||e.readyState===4)&&(i=undefined,b?e.readyState!==4&&e.abort():d=new m(e),c&&c(b,d))};return!d.async||e.readyState===4?i():e.onreadystatechange=i,e}},l=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,m=function(a){this.xhr=a,this.status=a.status,this.$nativeResponseHeaders=a.getAllResponseHeaders(),this.responses={};var b=a.responseXML;b&&b.documentElement&&(this.responses.xml=b),this.responses.text=a.responseText;try{this.statusText=a.statusText}catch(c){this.statusText=""}};m.prototype.getResponseHeader=function(a){var b;if(!this.$responseHeaders){this.$responseHeaders={};while(b=l.exec(this.$nativeResponseHeaders))this.$responseHeaders[b[1].toLowerCase()]=b[2]}return this.$responseHeaders[a.toLowerCase()]},k.ajaxSettings={type:"GET",contentType:"application/x-www-form-urlencoded",async:!0,xhr:function(){return new e},headers:{},data:null};var o=function(a,b,c){this.$requirejsContext=a,this.$applicationContext=b,this.$applicationFactory=null,this.$document=c},p=function(a,b){o.call(this,a),this.$config=b,this.$applicationContext=this};p.prototype=n(o.prototype),p.prototype.constructor=p,p.prototype.createApplicationInstance=function(a,b){var c=this.$applicationFactory,d=new o(this.$requirejsContext,this,a);this.$requirejsContext(["js/core/Application"],function(a){var e=new c(null,!1,d,null,null);if(e instanceof a)d.$application=e,e._initialize("auto"),b&&b(null,d,e);else{var f="mainClass isn't an instance of js.core.Application";if(!b)throw f;b(f)}})},p.prototype.getFqClassName=function(a,b,c){if(c==undefined||c==null)c=!0;if(a&&b){a=(this.$config.namespaceMap[a]||a).replace(/\./g,"/");var d=[a,b].join("/")}else d=(a||b).replace(/\./g,"/");f.indexOf(this.$config.xamlClasses,d)!==-1&&(d="xaml!"+d);if(c)for(var e=0;e<this.$config.rewriteMap.length;e++){var g=this.$config.rewriteMap[e];if(g instanceof k.rewriteMapEntry&&g.$from.test(d))return d.replace(g.$from,g.$to)}return d},p.prototype.createInstance=function(a,b,c){function e(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}b=b||[];var d;a instanceof Function?(d=a,a=d.prototype.constructor.name):(a=a.replace(/\./g,"/"),d=this.$requirejsContext(a)),c=c||a;var f;try{f=e(d,b),f.className=c}catch(g){console.log("Cannot create instance of '"+a+"'")}return f},p.prototype.ajax=function(a,b,c){!/^http.*$/.test(a)&&this.$config.applicationUrl&&(a=this.$config.applicationUrl+"/"+a),k.ajax(a,b,c)},k.defaultNamespaceMap=i,k.defaultRewriteMap=j,k.SystemManager=o,k.ApplicationContext=p,k.Rewrite=h,a.rAppid=k}(typeof exports!="undefined"?exports:window,typeof requirejs!="undefined"?requirejs:require("requirejs"),typeof requirejs!="undefined"?define:require("requirejs").define,typeof window!="undefined"?window.document:null,typeof window!="undefined"?window.XMLHttpRequest:require("xmlhttprequest").XMLHttpRequest),define("js/lib/rAppid",function(){}),define("xaml",[],function(){function h(a){return/\S/.test(a)}function i(a,b,c,d,e){c=c||{},e=e||{},d=d||[],a=(c[a]||a).replace(/\./g,"/");var f=[a,b].join("/");for(var g=0;g<e.length;g++){var h=e[g];if(h.$from&&h.$to&&h.$from.test(f)){f=f.replace(h.$from,h.$to);break}}return d.indexOf(f)!==-1&&(f="xaml!"+f),f.replace(/\./g,"/")}function j(a){var b=a.textContent||a.text||a.data;if(!b){b="";for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType==1||d.nodeType==4)b+=this._getTextContentFromDescriptor(d)}}return b}function k(a,b,c,d,e){function k(a){var l=g(a),m=i(a.namespaceURI,l,b,c,d);if(m=="js/core/Imports")for(var n=0;n<a.childNodes.length;n++){var o=a.childNodes[n];if(o.nodeType==3){var p,q=j(o);while((p=f.exec(q+" "))!=null){var r=p[0].replace(/\./g,"/");r!=="undefined"&&(h.indexOf(r)==-1&&h.push(r),e&&e.push(r))}}}h.indexOf(m)==-1&&h.push(m);for(var s=0;s<a.childNodes.length;s++){var t=a.childNodes[s];t.nodeType==1&&k(t)}}var h=[];return a&&k(a),h}function l(a,b,c,d){var e=[];for(var f=0;f<a.childNodes.length;f++){var h=a.childNodes[f];h.nodeType==1&&"js/core/Script"==i(h.namespaceURI,g(h),b,c,d)&&e.push(h)}return e}function m(a){var b={};if(a)for(var c=0;c<a.length;c++){var d=a[c];for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e])}return b}var a,b,c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=function(a,b){throw new Error("Environment unsupported.")},e={},f=/((?:xaml!)?[a-z]+(\.[a-z]+[a-z0-9]*)*)/mgi;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1});var g=function(a){if(a.localName)return a.localName;var b=a.tagName.split(":");return b[b.length-1]};return typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?(b=function(){var a,b,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(b=0;b<3;b++){d=c[b];try{a=new ActiveXObject(d)}catch(e){}if(a){c=[d];break}}if(!a)throw new Error("getXhr(): XMLHttpRequest not available");return a},d=function(a,c){var d;try{d=b(),d.open("GET",a,!0),d.onreadystatechange=function(){d.readyState===4&&(d.responseXML?c(null,d.responseXML):c("no responseXML found"))},d.send(null)}catch(e){c(e)}}):typeof process!="undefined"&&process.versions&&!!process.versions.node&&(a=require.nodeRequire("fs"),d=function(b,c){try{var d=a.readFileSync(b,"utf8");c(null,require.nodeRequire("libxml").parseFromString(d))}catch(e){c(e)}}),{write:function(a,b,c){if(b in e){var d=e[b];c.asModule(a+"!"+b,d)}},version:"0.2.0",load:function(a,b,c,f){var g=b.toUrl(a+".xml");d(g,function(d,i){if(!d&&i){var j=[],n=1,o=k(i.documentElement,f.namespaceMap,f.xamlClasses,f.rewriteMap,j),p=l(i.documentElement,f.namespaceMap,f.xamlClasses,f.rewriteMap);if(p.length>1)throw"only one script block allowed in XAML";p.length>0&&(o.splice(1,0,"js/core/Script"),n++),j.length>0&&(o=o.slice(0,n).concat(j).concat(o.slice(n)));if(f.isBuild){o.splice(1,0,"js/core/Element"),n++;var q="(function () {define(%dependencies%, %function%)}).call(this);",r="function(baseClass, ELEMENT %parameter%){return baseClass.inherit({ %classDefinition% _$descriptor: ELEMENT.xmlStringToDom(%descriptor%)})}";for(var s=0;s<o.length;s++)o[s]="'"+o[s]+"'";q=q.replace("%dependencies%","["+o.join(",")+"]");var t=i.documentElement.toString().replace(/((\r\n|\n|\r)[\s\t]*)/gm,"").replace(/'/g,"\\'").replace(/<js:Script[^>]*>[\s\S]*<\/js:Script[^>]*>/,""),u="",v="";if(p.length>0){var w=p[0].toString(),x=/^[\s\S]*?function\s*\(([\s\S]*?)\)[\s\S]*?\{[\s\S]*?return[\s\S]*?\{([\s\S]*)\}[\s\S]*?\}[\s\S]*?\)[^)]*$/,y=x.exec(w);if(!y)throw"Error parsing script block";h(y[1])&&(u=",SCRIPT,"+y[1]),h(y[2])&&(v=y[2]+",")}r=r.replace("%parameter%",u),r=r.replace("%classDefinition%",v),r=r.replace("%descriptor%","'"+t+"'"),q=q.replace("%function%",r),c.fromText(a,q),e[a]=q,b([a],function(a){c(a)})}else b(o,function(b){var d=arguments[0],e=arguments[1],f=Array.prototype.slice.call(arguments),g=[],h=f.slice(n);if(p.length>0)for(var j=0;j<p.length;j++)try{var k=new e(null,p[j]);g.push(k.evaluate(h))}catch(l){c.error(new Error(a+": Script cannot be loaded"+l))}var o=d.inherit(m(g));o.prototype._$descriptor=i.documentElement,c(o)},function(a){c.error(a)})}else c.error(new Error("XML "+g+" not found."+d))})}}}),define("json",["JSON"],function(a){var b,c,d=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],e=function(a,b){throw new Error("Environment unsupported.")},f={},g=/^(.+)\.json$/i;return typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?(c=function(){var a,b,c;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(b=0;b<3;b++){c=d[b];try{a=new ActiveXObject(c)}catch(e){}if(a){d=[c];break}}if(!a)throw new Error("getXhr(): XMLHttpRequest not available");return a},e=function(a,b){var d;try{d=c(),d.open("GET",a,!0),d.onreadystatechange=function(){d.readyState===4&&(d.responseText?b(null,d.responseText):b("no responseXML found"))},d.send(null)}catch(e){b(e)}}):typeof process!="undefined"&&process.versions&&!!process.versions.node&&(b=require.nodeRequire("fs"),e=function(a,c){try{var d=b.readFileSync(a,"utf8");c(null,d)}catch(e){c(e)}}),{write:function(a,b,c){if(b in f){var d=f[b];c.asModule(a+"!"+b,d)}},version:"0.1.0",load:function(b,c,d,f){b=b.replace(g,"$1"),b+=".json";var h=c.toUrl(b);e(h,function(b,c){b?d.error(new Error("Json for "+h+" not found")):d(a.parse(c))})}}})
